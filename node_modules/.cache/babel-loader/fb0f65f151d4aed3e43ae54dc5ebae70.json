{"remainingRequest":"E:\\自己的项目\\three_test\\node_modules\\babel-loader\\lib\\index.js!E:\\自己的项目\\three_test\\src\\assets\\jsm\\curves\\NURBSUtils.js","dependencies":[{"path":"E:\\自己的项目\\three_test\\src\\assets\\jsm\\curves\\NURBSUtils.js","mtime":1579613445639},{"path":"E:\\自己的项目\\three_test\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\自己的项目\\three_test\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3ViIjsKCi8qKgogKiBAYXV0aG9yIHJlbmVqCiAqIE5VUkJTIHV0aWxzCiAqCiAqIFNlZSBOVVJCU0N1cnZlIGFuZCBOVVJCU1N1cmZhY2UuCiAqCiAqKi8KaW1wb3J0IHsgVmVjdG9yMywgVmVjdG9yNCB9IGZyb20gIi4uLy4uL2pzL3RocmVlLm1vZHVsZS5qcyI7Ci8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKglOVVJCUyBVdGlscwogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgp2YXIgTlVSQlNVdGlscyA9IHsKICAvKgogIEZpbmRzIGtub3QgdmVjdG9yIHNwYW4uCiAgCXAgOiBkZWdyZWUKICB1IDogcGFyYW1ldHJpYyB2YWx1ZQogIFUgOiBrbm90IHZlY3RvcgogIAlyZXR1cm5zIHRoZSBzcGFuCiAgKi8KICBmaW5kU3BhbjogZnVuY3Rpb24gZmluZFNwYW4ocCwgdSwgVSkgewogICAgdmFyIG4gPSBVLmxlbmd0aCAtIHAgLSAxOwoKICAgIGlmICh1ID49IFVbbl0pIHsKICAgICAgcmV0dXJuIG4gLSAxOwogICAgfQoKICAgIGlmICh1IDw9IFVbcF0pIHsKICAgICAgcmV0dXJuIHA7CiAgICB9CgogICAgdmFyIGxvdyA9IHA7CiAgICB2YXIgaGlnaCA9IG47CiAgICB2YXIgbWlkID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTsKCiAgICB3aGlsZSAodSA8IFVbbWlkXSB8fCB1ID49IFVbbWlkICsgMV0pIHsKICAgICAgaWYgKHUgPCBVW21pZF0pIHsKICAgICAgICBoaWdoID0gbWlkOwogICAgICB9IGVsc2UgewogICAgICAgIGxvdyA9IG1pZDsKICAgICAgfQoKICAgICAgbWlkID0gTWF0aC5mbG9vcigobG93ICsgaGlnaCkgLyAyKTsKICAgIH0KCiAgICByZXR1cm4gbWlkOwogIH0sCgogIC8qCiAgQ2FsY3VsYXRlIGJhc2lzIGZ1bmN0aW9ucy4gU2VlIFRoZSBOVVJCUyBCb29rLCBwYWdlIDcwLCBhbGdvcml0aG0gQTIuMgogIAlzcGFuIDogc3BhbiBpbiB3aGljaCB1IGxpZXMKICB1ICAgIDogcGFyYW1ldHJpYyBwb2ludAogIHAgICAgOiBkZWdyZWUKICBVICAgIDoga25vdCB2ZWN0b3IKICAJcmV0dXJucyBhcnJheVtwKzFdIHdpdGggYmFzaXMgZnVuY3Rpb25zIHZhbHVlcy4KICAqLwogIGNhbGNCYXNpc0Z1bmN0aW9uczogZnVuY3Rpb24gY2FsY0Jhc2lzRnVuY3Rpb25zKHNwYW4sIHUsIHAsIFUpIHsKICAgIHZhciBOID0gW107CiAgICB2YXIgbGVmdCA9IFtdOwogICAgdmFyIHJpZ2h0ID0gW107CiAgICBOWzBdID0gMS4wOwoKICAgIGZvciAodmFyIGogPSAxOyBqIDw9IHA7ICsraikgewogICAgICBsZWZ0W2pdID0gdSAtIFVbc3BhbiArIDEgLSBqXTsKICAgICAgcmlnaHRbal0gPSBVW3NwYW4gKyBqXSAtIHU7CiAgICAgIHZhciBzYXZlZCA9IDAuMDsKCiAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgajsgKytyKSB7CiAgICAgICAgdmFyIHJ2ID0gcmlnaHRbciArIDFdOwogICAgICAgIHZhciBsdiA9IGxlZnRbaiAtIHJdOwogICAgICAgIHZhciB0ZW1wID0gTltyXSAvIChydiArIGx2KTsKICAgICAgICBOW3JdID0gc2F2ZWQgKyBydiAqIHRlbXA7CiAgICAgICAgc2F2ZWQgPSBsdiAqIHRlbXA7CiAgICAgIH0KCiAgICAgIE5bal0gPSBzYXZlZDsKICAgIH0KCiAgICByZXR1cm4gTjsKICB9LAoKICAvKgogIENhbGN1bGF0ZSBCLVNwbGluZSBjdXJ2ZSBwb2ludHMuIFNlZSBUaGUgTlVSQlMgQm9vaywgcGFnZSA4MiwgYWxnb3JpdGhtIEEzLjEuCiAgCXAgOiBkZWdyZWUgb2YgQi1TcGxpbmUKICBVIDoga25vdCB2ZWN0b3IKICBQIDogY29udHJvbCBwb2ludHMgKHgsIHksIHosIHcpCiAgdSA6IHBhcmFtZXRyaWMgcG9pbnQKICAJcmV0dXJucyBwb2ludCBmb3IgZ2l2ZW4gdQogICovCiAgY2FsY0JTcGxpbmVQb2ludDogZnVuY3Rpb24gY2FsY0JTcGxpbmVQb2ludChwLCBVLCBQLCB1KSB7CiAgICB2YXIgc3BhbiA9IHRoaXMuZmluZFNwYW4ocCwgdSwgVSk7CiAgICB2YXIgTiA9IHRoaXMuY2FsY0Jhc2lzRnVuY3Rpb25zKHNwYW4sIHUsIHAsIFUpOwogICAgdmFyIEMgPSBuZXcgVmVjdG9yNCgwLCAwLCAwLCAwKTsKCiAgICBmb3IgKHZhciBqID0gMDsgaiA8PSBwOyArK2opIHsKICAgICAgdmFyIHBvaW50ID0gUFtzcGFuIC0gcCArIGpdOwogICAgICB2YXIgTmogPSBOW2pdOwogICAgICB2YXIgd05qID0gcG9pbnQudyAqIE5qOwogICAgICBDLnggKz0gcG9pbnQueCAqIHdOajsKICAgICAgQy55ICs9IHBvaW50LnkgKiB3Tmo7CiAgICAgIEMueiArPSBwb2ludC56ICogd05qOwogICAgICBDLncgKz0gcG9pbnQudyAqIE5qOwogICAgfQoKICAgIHJldHVybiBDOwogIH0sCgogIC8qCiAgQ2FsY3VsYXRlIGJhc2lzIGZ1bmN0aW9ucyBkZXJpdmF0aXZlcy4gU2VlIFRoZSBOVVJCUyBCb29rLCBwYWdlIDcyLCBhbGdvcml0aG0gQTIuMy4KICAJc3BhbiA6IHNwYW4gaW4gd2hpY2ggdSBsaWVzCiAgdSAgICA6IHBhcmFtZXRyaWMgcG9pbnQKICBwICAgIDogZGVncmVlCiAgbiAgICA6IG51bWJlciBvZiBkZXJpdmF0aXZlcyB0byBjYWxjdWxhdGUKICBVICAgIDoga25vdCB2ZWN0b3IKICAJcmV0dXJucyBhcnJheVtuKzFdW3ArMV0gd2l0aCBiYXNpcyBmdW5jdGlvbnMgZGVyaXZhdGl2ZXMKICAqLwogIGNhbGNCYXNpc0Z1bmN0aW9uRGVyaXZhdGl2ZXM6IGZ1bmN0aW9uIGNhbGNCYXNpc0Z1bmN0aW9uRGVyaXZhdGl2ZXMoc3BhbiwgdSwgcCwgbiwgVSkgewogICAgdmFyIHplcm9BcnIgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBwOyArK2kpIHsKICAgICAgemVyb0FycltpXSA9IDAuMDsKICAgIH0KCiAgICB2YXIgZGVycyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IG47ICsraSkgewogICAgICBkZXJzW2ldID0gemVyb0Fyci5zbGljZSgwKTsKICAgIH0KCiAgICB2YXIgbmR1ID0gW107CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gcDsgKytpKSB7CiAgICAgIG5kdVtpXSA9IHplcm9BcnIuc2xpY2UoMCk7CiAgICB9CgogICAgbmR1WzBdWzBdID0gMS4wOwogICAgdmFyIGxlZnQgPSB6ZXJvQXJyLnNsaWNlKDApOwogICAgdmFyIHJpZ2h0ID0gemVyb0Fyci5zbGljZSgwKTsKCiAgICBmb3IgKHZhciBqID0gMTsgaiA8PSBwOyArK2opIHsKICAgICAgbGVmdFtqXSA9IHUgLSBVW3NwYW4gKyAxIC0gal07CiAgICAgIHJpZ2h0W2pdID0gVVtzcGFuICsgal0gLSB1OwogICAgICB2YXIgc2F2ZWQgPSAwLjA7CgogICAgICBmb3IgKHZhciByID0gMDsgciA8IGo7ICsrcikgewogICAgICAgIHZhciBydiA9IHJpZ2h0W3IgKyAxXTsKICAgICAgICB2YXIgbHYgPSBsZWZ0W2ogLSByXTsKICAgICAgICBuZHVbal1bcl0gPSBydiArIGx2OwogICAgICAgIHZhciB0ZW1wID0gbmR1W3JdW2ogLSAxXSAvIG5kdVtqXVtyXTsKICAgICAgICBuZHVbcl1bal0gPSBzYXZlZCArIHJ2ICogdGVtcDsKICAgICAgICBzYXZlZCA9IGx2ICogdGVtcDsKICAgICAgfQoKICAgICAgbmR1W2pdW2pdID0gc2F2ZWQ7CiAgICB9CgogICAgZm9yICh2YXIgaiA9IDA7IGogPD0gcDsgKytqKSB7CiAgICAgIGRlcnNbMF1bal0gPSBuZHVbal1bcF07CiAgICB9CgogICAgZm9yICh2YXIgciA9IDA7IHIgPD0gcDsgKytyKSB7CiAgICAgIHZhciBzMSA9IDA7CiAgICAgIHZhciBzMiA9IDE7CiAgICAgIHZhciBhID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBwOyArK2kpIHsKICAgICAgICBhW2ldID0gemVyb0Fyci5zbGljZSgwKTsKICAgICAgfQoKICAgICAgYVswXVswXSA9IDEuMDsKCiAgICAgIGZvciAodmFyIGsgPSAxOyBrIDw9IG47ICsraykgewogICAgICAgIHZhciBkID0gMC4wOwogICAgICAgIHZhciByayA9IHIgLSBrOwogICAgICAgIHZhciBwayA9IHAgLSBrOwoKICAgICAgICBpZiAociA+PSBrKSB7CiAgICAgICAgICBhW3MyXVswXSA9IGFbczFdWzBdIC8gbmR1W3BrICsgMV1bcmtdOwogICAgICAgICAgZCA9IGFbczJdWzBdICogbmR1W3JrXVtwa107CiAgICAgICAgfQoKICAgICAgICB2YXIgajEgPSByayA+PSAtMSA/IDEgOiAtcms7CiAgICAgICAgdmFyIGoyID0gciAtIDEgPD0gcGsgPyBrIC0gMSA6IHAgLSByOwoKICAgICAgICBmb3IgKHZhciBqID0gajE7IGogPD0gajI7ICsraikgewogICAgICAgICAgYVtzMl1bal0gPSAoYVtzMV1bal0gLSBhW3MxXVtqIC0gMV0pIC8gbmR1W3BrICsgMV1bcmsgKyBqXTsKICAgICAgICAgIGQgKz0gYVtzMl1bal0gKiBuZHVbcmsgKyBqXVtwa107CiAgICAgICAgfQoKICAgICAgICBpZiAociA8PSBwaykgewogICAgICAgICAgYVtzMl1ba10gPSAtYVtzMV1bayAtIDFdIC8gbmR1W3BrICsgMV1bcl07CiAgICAgICAgICBkICs9IGFbczJdW2tdICogbmR1W3JdW3BrXTsKICAgICAgICB9CgogICAgICAgIGRlcnNba11bcl0gPSBkOwogICAgICAgIHZhciBqID0gczE7CiAgICAgICAgczEgPSBzMjsKICAgICAgICBzMiA9IGo7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgciA9IHA7CgogICAgZm9yICh2YXIgayA9IDE7IGsgPD0gbjsgKytrKSB7CiAgICAgIGZvciAodmFyIGogPSAwOyBqIDw9IHA7ICsraikgewogICAgICAgIGRlcnNba11bal0gKj0gcjsKICAgICAgfQoKICAgICAgciAqPSBwIC0gazsKICAgIH0KCiAgICByZXR1cm4gZGVyczsKICB9LAoKICAvKgogIAlDYWxjdWxhdGUgZGVyaXZhdGl2ZXMgb2YgYSBCLVNwbGluZS4gU2VlIFRoZSBOVVJCUyBCb29rLCBwYWdlIDkzLCBhbGdvcml0aG0gQTMuMi4KICAJCXAgIDogZGVncmVlCiAgCVUgIDoga25vdCB2ZWN0b3IKICAJUCAgOiBjb250cm9sIHBvaW50cwogIAl1ICA6IFBhcmFtZXRyaWMgcG9pbnRzCiAgCW5kIDogbnVtYmVyIG9mIGRlcml2YXRpdmVzCiAgCQlyZXR1cm5zIGFycmF5W2QrMV0gd2l0aCBkZXJpdmF0aXZlcwogIAkqLwogIGNhbGNCU3BsaW5lRGVyaXZhdGl2ZXM6IGZ1bmN0aW9uIGNhbGNCU3BsaW5lRGVyaXZhdGl2ZXMocCwgVSwgUCwgdSwgbmQpIHsKICAgIHZhciBkdSA9IG5kIDwgcCA/IG5kIDogcDsKICAgIHZhciBDSyA9IFtdOwogICAgdmFyIHNwYW4gPSB0aGlzLmZpbmRTcGFuKHAsIHUsIFUpOwogICAgdmFyIG5kZXJzID0gdGhpcy5jYWxjQmFzaXNGdW5jdGlvbkRlcml2YXRpdmVzKHNwYW4sIHUsIHAsIGR1LCBVKTsKICAgIHZhciBQdyA9IFtdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgUC5sZW5ndGg7ICsraSkgewogICAgICB2YXIgcG9pbnQgPSBQW2ldLmNsb25lKCk7CiAgICAgIHZhciB3ID0gcG9pbnQudzsKICAgICAgcG9pbnQueCAqPSB3OwogICAgICBwb2ludC55ICo9IHc7CiAgICAgIHBvaW50LnogKj0gdzsKICAgICAgUHdbaV0gPSBwb2ludDsKICAgIH0KCiAgICBmb3IgKHZhciBrID0gMDsgayA8PSBkdTsgKytrKSB7CiAgICAgIHZhciBwb2ludCA9IFB3W3NwYW4gLSBwXS5jbG9uZSgpLm11bHRpcGx5U2NhbGFyKG5kZXJzW2tdWzBdKTsKCiAgICAgIGZvciAodmFyIGogPSAxOyBqIDw9IHA7ICsraikgewogICAgICAgIHBvaW50LmFkZChQd1tzcGFuIC0gcCArIGpdLmNsb25lKCkubXVsdGlwbHlTY2FsYXIobmRlcnNba11bal0pKTsKICAgICAgfQoKICAgICAgQ0tba10gPSBwb2ludDsKICAgIH0KCiAgICBmb3IgKHZhciBrID0gZHUgKyAxOyBrIDw9IG5kICsgMTsgKytrKSB7CiAgICAgIENLW2tdID0gbmV3IFZlY3RvcjQoMCwgMCwgMCk7CiAgICB9CgogICAgcmV0dXJuIENLOwogIH0sCgogIC8qCiAgQ2FsY3VsYXRlICJLIG92ZXIgSSIKICAJcmV0dXJucyBrIS8oaSEoay1pKSEpCiAgKi8KICBjYWxjS292ZXJJOiBmdW5jdGlvbiBjYWxjS292ZXJJKGssIGkpIHsKICAgIHZhciBub20gPSAxOwoKICAgIGZvciAodmFyIGogPSAyOyBqIDw9IGs7ICsraikgewogICAgICBub20gKj0gajsKICAgIH0KCiAgICB2YXIgZGVub20gPSAxOwoKICAgIGZvciAodmFyIGogPSAyOyBqIDw9IGk7ICsraikgewogICAgICBkZW5vbSAqPSBqOwogICAgfQoKICAgIGZvciAodmFyIGogPSAyOyBqIDw9IGsgLSBpOyArK2opIHsKICAgICAgZGVub20gKj0gajsKICAgIH0KCiAgICByZXR1cm4gbm9tIC8gZGVub207CiAgfSwKCiAgLyoKICBDYWxjdWxhdGUgZGVyaXZhdGl2ZXMgKDAtbmQpIG9mIHJhdGlvbmFsIGN1cnZlLiBTZWUgVGhlIE5VUkJTIEJvb2ssIHBhZ2UgMTI3LCBhbGdvcml0aG0gQTQuMi4KICAJUGRlcnMgOiByZXN1bHQgb2YgZnVuY3Rpb24gY2FsY0JTcGxpbmVEZXJpdmF0aXZlcwogIAlyZXR1cm5zIGFycmF5IHdpdGggZGVyaXZhdGl2ZXMgZm9yIHJhdGlvbmFsIGN1cnZlLgogICovCiAgY2FsY1JhdGlvbmFsQ3VydmVEZXJpdmF0aXZlczogZnVuY3Rpb24gY2FsY1JhdGlvbmFsQ3VydmVEZXJpdmF0aXZlcyhQZGVycykgewogICAgdmFyIG5kID0gUGRlcnMubGVuZ3RoOwogICAgdmFyIEFkZXJzID0gW107CiAgICB2YXIgd2RlcnMgPSBbXTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5kOyArK2kpIHsKICAgICAgdmFyIHBvaW50ID0gUGRlcnNbaV07CiAgICAgIEFkZXJzW2ldID0gbmV3IFZlY3RvcjMocG9pbnQueCwgcG9pbnQueSwgcG9pbnQueik7CiAgICAgIHdkZXJzW2ldID0gcG9pbnQudzsKICAgIH0KCiAgICB2YXIgQ0sgPSBbXTsKCiAgICBmb3IgKHZhciBrID0gMDsgayA8IG5kOyArK2spIHsKICAgICAgdmFyIHYgPSBBZGVyc1trXS5jbG9uZSgpOwoKICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gazsgKytpKSB7CiAgICAgICAgdi5zdWIoQ0tbayAtIGldLmNsb25lKCkubXVsdGlwbHlTY2FsYXIodGhpcy5jYWxjS292ZXJJKGssIGkpICogd2RlcnNbaV0pKTsKICAgICAgfQoKICAgICAgQ0tba10gPSB2LmRpdmlkZVNjYWxhcih3ZGVyc1swXSk7CiAgICB9CgogICAgcmV0dXJuIENLOwogIH0sCgogIC8qCiAgQ2FsY3VsYXRlIE5VUkJTIGN1cnZlIGRlcml2YXRpdmVzLiBTZWUgVGhlIE5VUkJTIEJvb2ssIHBhZ2UgMTI3LCBhbGdvcml0aG0gQTQuMi4KICAJcCAgOiBkZWdyZWUKICBVICA6IGtub3QgdmVjdG9yCiAgUCAgOiBjb250cm9sIHBvaW50cyBpbiBob21vZ2VuZW91cyBzcGFjZQogIHUgIDogcGFyYW1ldHJpYyBwb2ludHMKICBuZCA6IG51bWJlciBvZiBkZXJpdmF0aXZlcwogIAlyZXR1cm5zIGFycmF5IHdpdGggZGVyaXZhdGl2ZXMuCiAgKi8KICBjYWxjTlVSQlNEZXJpdmF0aXZlczogZnVuY3Rpb24gY2FsY05VUkJTRGVyaXZhdGl2ZXMocCwgVSwgUCwgdSwgbmQpIHsKICAgIHZhciBQZGVycyA9IHRoaXMuY2FsY0JTcGxpbmVEZXJpdmF0aXZlcyhwLCBVLCBQLCB1LCBuZCk7CiAgICByZXR1cm4gdGhpcy5jYWxjUmF0aW9uYWxDdXJ2ZURlcml2YXRpdmVzKFBkZXJzKTsKICB9LAoKICAvKgogIENhbGN1bGF0ZSByYXRpb25hbCBCLVNwbGluZSBzdXJmYWNlIHBvaW50LiBTZWUgVGhlIE5VUkJTIEJvb2ssIHBhZ2UgMTM0LCBhbGdvcml0aG0gQTQuMy4KICAJcDEsIHAyIDogZGVncmVlcyBvZiBCLVNwbGluZSBzdXJmYWNlCiAgVTEsIFUyIDoga25vdCB2ZWN0b3JzCiAgUCAgICAgIDogY29udHJvbCBwb2ludHMgKHgsIHksIHosIHcpCiAgdSwgdiAgIDogcGFyYW1ldHJpYyB2YWx1ZXMKICAJcmV0dXJucyBwb2ludCBmb3IgZ2l2ZW4gKHUsIHYpCiAgKi8KICBjYWxjU3VyZmFjZVBvaW50OiBmdW5jdGlvbiBjYWxjU3VyZmFjZVBvaW50KHAsIHEsIFUsIFYsIFAsIHUsIHYsIHRhcmdldCkgewogICAgdmFyIHVzcGFuID0gdGhpcy5maW5kU3BhbihwLCB1LCBVKTsKICAgIHZhciB2c3BhbiA9IHRoaXMuZmluZFNwYW4ocSwgdiwgVik7CiAgICB2YXIgTnUgPSB0aGlzLmNhbGNCYXNpc0Z1bmN0aW9ucyh1c3BhbiwgdSwgcCwgVSk7CiAgICB2YXIgTnYgPSB0aGlzLmNhbGNCYXNpc0Z1bmN0aW9ucyh2c3BhbiwgdiwgcSwgVik7CiAgICB2YXIgdGVtcCA9IFtdOwoKICAgIGZvciAodmFyIGwgPSAwOyBsIDw9IHE7ICsrbCkgewogICAgICB0ZW1wW2xdID0gbmV3IFZlY3RvcjQoMCwgMCwgMCwgMCk7CgogICAgICBmb3IgKHZhciBrID0gMDsgayA8PSBwOyArK2spIHsKICAgICAgICB2YXIgcG9pbnQgPSBQW3VzcGFuIC0gcCArIGtdW3ZzcGFuIC0gcSArIGxdLmNsb25lKCk7CiAgICAgICAgdmFyIHcgPSBwb2ludC53OwogICAgICAgIHBvaW50LnggKj0gdzsKICAgICAgICBwb2ludC55ICo9IHc7CiAgICAgICAgcG9pbnQueiAqPSB3OwogICAgICAgIHRlbXBbbF0uYWRkKHBvaW50Lm11bHRpcGx5U2NhbGFyKE51W2tdKSk7CiAgICAgIH0KICAgIH0KCiAgICB2YXIgU3cgPSBuZXcgVmVjdG9yNCgwLCAwLCAwLCAwKTsKCiAgICBmb3IgKHZhciBsID0gMDsgbCA8PSBxOyArK2wpIHsKICAgICAgU3cuYWRkKHRlbXBbbF0ubXVsdGlwbHlTY2FsYXIoTnZbbF0pKTsKICAgIH0KCiAgICBTdy5kaXZpZGVTY2FsYXIoU3cudyk7CiAgICB0YXJnZXQuc2V0KFN3LngsIFN3LnksIFN3LnopOwogIH0KfTsKZXhwb3J0IHsgTlVSQlNVdGlscyB9Ow=="},{"version":3,"sources":["E:/自己的项目/three_test/src/assets/jsm/curves/NURBSUtils.js"],"names":["Vector3","Vector4","NURBSUtils","findSpan","p","u","U","n","length","low","high","mid","Math","floor","calcBasisFunctions","span","N","left","right","j","saved","r","rv","lv","temp","calcBSplinePoint","P","C","point","Nj","wNj","w","x","y","z","calcBasisFunctionDerivatives","zeroArr","i","ders","slice","ndu","s1","s2","a","k","d","rk","pk","j1","j2","calcBSplineDerivatives","nd","du","CK","nders","Pw","clone","multiplyScalar","add","calcKoverI","nom","denom","calcRationalCurveDerivatives","Pders","Aders","wders","v","sub","divideScalar","calcNURBSDerivatives","calcSurfacePoint","q","V","target","uspan","vspan","Nu","Nv","l","Sw","set"],"mappings":"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","sourcesContent":["/**\n * @author renej\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n *\n **/\n\nimport {\n\tVector3,\n\tVector4\n} from \"../../js/three.module.js\";\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\nvar NURBSUtils = {\n\n\t/*\n\tFinds knot vector span.\n\n\tp : degree\n\tu : parametric value\n\tU : knot vector\n\n\treturns the span\n\t*/\n\tfindSpan: function (p, u, U) {\n\n\t\tvar n = U.length - p - 1;\n\n\t\tif (u >= U[n]) {\n\n\t\t\treturn n - 1;\n\n\t\t}\n\n\t\tif (u <= U[p]) {\n\n\t\t\treturn p;\n\n\t\t}\n\n\t\tvar low = p;\n\t\tvar high = n;\n\t\tvar mid = Math.floor((low + high) / 2);\n\n\t\twhile (u < U[mid] || u >= U[mid + 1]) {\n\n\t\t\tif (u < U[mid]) {\n\n\t\t\t\thigh = mid;\n\n\t\t\t} else {\n\n\t\t\t\tlow = mid;\n\n\t\t\t}\n\n\t\t\tmid = Math.floor((low + high) / 2);\n\n\t\t}\n\n\t\treturn mid;\n\n\t},\n\n\n\t/*\n\tCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\n\tspan : span in which u lies\n\tu    : parametric point\n\tp    : degree\n\tU    : knot vector\n\n\treturns array[p+1] with basis functions values.\n\t*/\n\tcalcBasisFunctions: function (span, u, p, U) {\n\n\t\tvar N = [];\n\t\tvar left = [];\n\t\tvar right = [];\n\t\tN[0] = 1.0;\n\n\t\tfor (var j = 1; j <= p; ++j) {\n\n\t\t\tleft[j] = u - U[span + 1 - j];\n\t\t\tright[j] = U[span + j] - u;\n\n\t\t\tvar saved = 0.0;\n\n\t\t\tfor (var r = 0; r < j; ++r) {\n\n\t\t\t\tvar rv = right[r + 1];\n\t\t\t\tvar lv = left[j - r];\n\t\t\t\tvar temp = N[r] / (rv + lv);\n\t\t\t\tN[r] = saved + rv * temp;\n\t\t\t\tsaved = lv * temp;\n\n\t\t\t}\n\n\t\t\tN[j] = saved;\n\n\t\t}\n\n\t\treturn N;\n\n\t},\n\n\n\t/*\n\tCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\n\tp : degree of B-Spline\n\tU : knot vector\n\tP : control points (x, y, z, w)\n\tu : parametric point\n\n\treturns point for given u\n\t*/\n\tcalcBSplinePoint: function (p, U, P, u) {\n\n\t\tvar span = this.findSpan(p, u, U);\n\t\tvar N = this.calcBasisFunctions(span, u, p, U);\n\t\tvar C = new Vector4(0, 0, 0, 0);\n\n\t\tfor (var j = 0; j <= p; ++j) {\n\n\t\t\tvar point = P[span - p + j];\n\t\t\tvar Nj = N[j];\n\t\t\tvar wNj = point.w * Nj;\n\t\t\tC.x += point.x * wNj;\n\t\t\tC.y += point.y * wNj;\n\t\t\tC.z += point.z * wNj;\n\t\t\tC.w += point.w * Nj;\n\n\t\t}\n\n\t\treturn C;\n\n\t},\n\n\n\t/*\n\tCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\n\tspan : span in which u lies\n\tu    : parametric point\n\tp    : degree\n\tn    : number of derivatives to calculate\n\tU    : knot vector\n\n\treturns array[n+1][p+1] with basis functions derivatives\n\t*/\n\tcalcBasisFunctionDerivatives: function (span, u, p, n, U) {\n\n\t\tvar zeroArr = [];\n\t\tfor (var i = 0; i <= p; ++i)\n\t\t\tzeroArr[i] = 0.0;\n\n\t\tvar ders = [];\n\t\tfor (var i = 0; i <= n; ++i)\n\t\t\tders[i] = zeroArr.slice(0);\n\n\t\tvar ndu = [];\n\t\tfor (var i = 0; i <= p; ++i)\n\t\t\tndu[i] = zeroArr.slice(0);\n\n\t\tndu[0][0] = 1.0;\n\n\t\tvar left = zeroArr.slice(0);\n\t\tvar right = zeroArr.slice(0);\n\n\t\tfor (var j = 1; j <= p; ++j) {\n\n\t\t\tleft[j] = u - U[span + 1 - j];\n\t\t\tright[j] = U[span + j] - u;\n\n\t\t\tvar saved = 0.0;\n\n\t\t\tfor (var r = 0; r < j; ++r) {\n\n\t\t\t\tvar rv = right[r + 1];\n\t\t\t\tvar lv = left[j - r];\n\t\t\t\tndu[j][r] = rv + lv;\n\n\t\t\t\tvar temp = ndu[r][j - 1] / ndu[j][r];\n\t\t\t\tndu[r][j] = saved + rv * temp;\n\t\t\t\tsaved = lv * temp;\n\n\t\t\t}\n\n\t\t\tndu[j][j] = saved;\n\n\t\t}\n\n\t\tfor (var j = 0; j <= p; ++j) {\n\n\t\t\tders[0][j] = ndu[j][p];\n\n\t\t}\n\n\t\tfor (var r = 0; r <= p; ++r) {\n\n\t\t\tvar s1 = 0;\n\t\t\tvar s2 = 1;\n\n\t\t\tvar a = [];\n\t\t\tfor (var i = 0; i <= p; ++i) {\n\n\t\t\t\ta[i] = zeroArr.slice(0);\n\n\t\t\t}\n\t\t\ta[0][0] = 1.0;\n\n\t\t\tfor (var k = 1; k <= n; ++k) {\n\n\t\t\t\tvar d = 0.0;\n\t\t\t\tvar rk = r - k;\n\t\t\t\tvar pk = p - k;\n\n\t\t\t\tif (r >= k) {\n\n\t\t\t\t\ta[s2][0] = a[s1][0] / ndu[pk + 1][rk];\n\t\t\t\t\td = a[s2][0] * ndu[rk][pk];\n\n\t\t\t\t}\n\n\t\t\t\tvar j1 = (rk >= - 1) ? 1 : - rk;\n\t\t\t\tvar j2 = (r - 1 <= pk) ? k - 1 : p - r;\n\n\t\t\t\tfor (var j = j1; j <= j2; ++j) {\n\n\t\t\t\t\ta[s2][j] = (a[s1][j] - a[s1][j - 1]) / ndu[pk + 1][rk + j];\n\t\t\t\t\td += a[s2][j] * ndu[rk + j][pk];\n\n\t\t\t\t}\n\n\t\t\t\tif (r <= pk) {\n\n\t\t\t\t\ta[s2][k] = - a[s1][k - 1] / ndu[pk + 1][r];\n\t\t\t\t\td += a[s2][k] * ndu[r][pk];\n\n\t\t\t\t}\n\n\t\t\t\tders[k][r] = d;\n\n\t\t\t\tvar j = s1;\n\t\t\t\ts1 = s2;\n\t\t\t\ts2 = j;\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar r = p;\n\n\t\tfor (var k = 1; k <= n; ++k) {\n\n\t\t\tfor (var j = 0; j <= p; ++j) {\n\n\t\t\t\tders[k][j] *= r;\n\n\t\t\t}\n\t\t\tr *= p - k;\n\n\t\t}\n\n\t\treturn ders;\n\n\t},\n\n\n\t/*\n\t\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\t\tp  : degree\n\t\tU  : knot vector\n\t\tP  : control points\n\t\tu  : Parametric points\n\t\tnd : number of derivatives\n\n\t\treturns array[d+1] with derivatives\n\t\t*/\n\tcalcBSplineDerivatives: function (p, U, P, u, nd) {\n\n\t\tvar du = nd < p ? nd : p;\n\t\tvar CK = [];\n\t\tvar span = this.findSpan(p, u, U);\n\t\tvar nders = this.calcBasisFunctionDerivatives(span, u, p, du, U);\n\t\tvar Pw = [];\n\n\t\tfor (var i = 0; i < P.length; ++i) {\n\n\t\t\tvar point = P[i].clone();\n\t\t\tvar w = point.w;\n\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\n\t\t\tPw[i] = point;\n\n\t\t}\n\t\tfor (var k = 0; k <= du; ++k) {\n\n\t\t\tvar point = Pw[span - p].clone().multiplyScalar(nders[k][0]);\n\n\t\t\tfor (var j = 1; j <= p; ++j) {\n\n\t\t\t\tpoint.add(Pw[span - p + j].clone().multiplyScalar(nders[k][j]));\n\n\t\t\t}\n\n\t\t\tCK[k] = point;\n\n\t\t}\n\n\t\tfor (var k = du + 1; k <= nd + 1; ++k) {\n\n\t\t\tCK[k] = new Vector4(0, 0, 0);\n\n\t\t}\n\n\t\treturn CK;\n\n\t},\n\n\n\t/*\n\tCalculate \"K over I\"\n\n\treturns k!/(i!(k-i)!)\n\t*/\n\tcalcKoverI: function (k, i) {\n\n\t\tvar nom = 1;\n\n\t\tfor (var j = 2; j <= k; ++j) {\n\n\t\t\tnom *= j;\n\n\t\t}\n\n\t\tvar denom = 1;\n\n\t\tfor (var j = 2; j <= i; ++j) {\n\n\t\t\tdenom *= j;\n\n\t\t}\n\n\t\tfor (var j = 2; j <= k - i; ++j) {\n\n\t\t\tdenom *= j;\n\n\t\t}\n\n\t\treturn nom / denom;\n\n\t},\n\n\n\t/*\n\tCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\n\tPders : result of function calcBSplineDerivatives\n\n\treturns array with derivatives for rational curve.\n\t*/\n\tcalcRationalCurveDerivatives: function (Pders) {\n\n\t\tvar nd = Pders.length;\n\t\tvar Aders = [];\n\t\tvar wders = [];\n\n\t\tfor (var i = 0; i < nd; ++i) {\n\n\t\t\tvar point = Pders[i];\n\t\t\tAders[i] = new Vector3(point.x, point.y, point.z);\n\t\t\twders[i] = point.w;\n\n\t\t}\n\n\t\tvar CK = [];\n\n\t\tfor (var k = 0; k < nd; ++k) {\n\n\t\t\tvar v = Aders[k].clone();\n\n\t\t\tfor (var i = 1; i <= k; ++i) {\n\n\t\t\t\tv.sub(CK[k - i].clone().multiplyScalar(this.calcKoverI(k, i) * wders[i]));\n\n\t\t\t}\n\n\t\t\tCK[k] = v.divideScalar(wders[0]);\n\n\t\t}\n\n\t\treturn CK;\n\n\t},\n\n\n\t/*\n\tCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points in homogeneous space\n\tu  : parametric points\n\tnd : number of derivatives\n\n\treturns array with derivatives.\n\t*/\n\tcalcNURBSDerivatives: function (p, U, P, u, nd) {\n\n\t\tvar Pders = this.calcBSplineDerivatives(p, U, P, u, nd);\n\t\treturn this.calcRationalCurveDerivatives(Pders);\n\n\t},\n\n\n\t/*\n\tCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\n\tp1, p2 : degrees of B-Spline surface\n\tU1, U2 : knot vectors\n\tP      : control points (x, y, z, w)\n\tu, v   : parametric values\n\n\treturns point for given (u, v)\n\t*/\n\tcalcSurfacePoint: function (p, q, U, V, P, u, v, target) {\n\n\t\tvar uspan = this.findSpan(p, u, U);\n\t\tvar vspan = this.findSpan(q, v, V);\n\t\tvar Nu = this.calcBasisFunctions(uspan, u, p, U);\n\t\tvar Nv = this.calcBasisFunctions(vspan, v, q, V);\n\t\tvar temp = [];\n\n\t\tfor (var l = 0; l <= q; ++l) {\n\n\t\t\ttemp[l] = new Vector4(0, 0, 0, 0);\n\t\t\tfor (var k = 0; k <= p; ++k) {\n\n\t\t\t\tvar point = P[uspan - p + k][vspan - q + l].clone();\n\t\t\t\tvar w = point.w;\n\t\t\t\tpoint.x *= w;\n\t\t\t\tpoint.y *= w;\n\t\t\t\tpoint.z *= w;\n\t\t\t\ttemp[l].add(point.multiplyScalar(Nu[k]));\n\n\t\t\t}\n\n\t\t}\n\n\t\tvar Sw = new Vector4(0, 0, 0, 0);\n\t\tfor (var l = 0; l <= q; ++l) {\n\n\t\t\tSw.add(temp[l].multiplyScalar(Nv[l]));\n\n\t\t}\n\n\t\tSw.divideScalar(Sw.w);\n\t\ttarget.set(Sw.x, Sw.y, Sw.z);\n\n\t}\n\n};\n\nexport { NURBSUtils };\n"]}]}