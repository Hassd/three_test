{"remainingRequest":"E:\\自己的项目\\three_test\\node_modules\\babel-loader\\lib\\index.js!E:\\自己的项目\\three_test\\src\\assets\\jsm\\loaders\\obj2\\worker\\parallel\\OBJLoader2Parser.js","dependencies":[{"path":"E:\\自己的项目\\three_test\\src\\assets\\jsm\\loaders\\obj2\\worker\\parallel\\OBJLoader2Parser.js","mtime":1579613441470},{"path":"E:\\自己的项目\\three_test\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\自己的项目\\three_test\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wYXJzZS1mbG9hdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnBhcnNlLWludCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmxvYXQzMi1hcnJheSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnVpbnQ4LWFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudWludDMyLWFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuY29weS13aXRoaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5ldmVyeSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbGwiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWx0ZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuam9pbiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5Lmxhc3QtaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZWR1Y2UtcmlnaHQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5yZXZlcnNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2V0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29ydCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnN1YmFycmF5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkudG8tbG9jYWxlLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXN0cmluZyI7CgovKioKICogQGF1dGhvciBLYWkgU2FsbWVuIC8gaHR0cHM6Ly9rYWlzYWxtZW4uZGUKICogRGV2ZWxvcG1lbnQgcmVwb3NpdG9yeTogaHR0cHM6Ly9naXRodWIuY29tL2thaXNhbG1lbi9XV09CSkxvYWRlcgogKi8KCi8qKgogKiBQYXJzZSBPQkogZGF0YSBlaXRoZXIgZnJvbSBBcnJheUJ1ZmZlciBvciBzdHJpbmcKICovCnZhciBPQkpMb2FkZXIyUGFyc2VyID0gZnVuY3Rpb24gT0JKTG9hZGVyMlBhcnNlcigpIHsKICB0aGlzLmxvZ2dpbmcgPSB7CiAgICBlbmFibGVkOiBmYWxzZSwKICAgIGRlYnVnOiBmYWxzZQogIH07CiAgdmFyIHNjb3BlID0gdGhpczsKICB0aGlzLmNhbGxiYWNrcyA9IHsKICAgIG9uUHJvZ3Jlc3M6IGZ1bmN0aW9uIG9uUHJvZ3Jlc3ModGV4dCkgewogICAgICBzY29wZS5fb25Qcm9ncmVzcyh0ZXh0KTsKICAgIH0sCiAgICBvbkFzc2V0QXZhaWxhYmxlOiBmdW5jdGlvbiBvbkFzc2V0QXZhaWxhYmxlKHBheWxvYWQpIHsKICAgICAgc2NvcGUuX29uQXNzZXRBdmFpbGFibGUocGF5bG9hZCk7CiAgICB9LAogICAgb25FcnJvcjogZnVuY3Rpb24gb25FcnJvcihlcnJvck1lc3NhZ2UpIHsKICAgICAgc2NvcGUuX29uRXJyb3IoZXJyb3JNZXNzYWdlKTsKICAgIH0sCiAgICBvbkxvYWQ6IGZ1bmN0aW9uIG9uTG9hZChvYmplY3QzZCwgbWVzc2FnZSkgewogICAgICBzY29wZS5fb25Mb2FkKG9iamVjdDNkLCBtZXNzYWdlKTsKICAgIH0KICB9OwogIHRoaXMuY29udGVudFJlZiA9IG51bGw7CiAgdGhpcy5sZWdhY3lNb2RlID0gZmFsc2U7CiAgdGhpcy5tYXRlcmlhbHMgPSB7fTsKICB0aGlzLm1hdGVyaWFsUGVyU21vb3RoaW5nR3JvdXAgPSBmYWxzZTsKICB0aGlzLnVzZU9Bc01lc2ggPSBmYWxzZTsKICB0aGlzLnVzZUluZGljZXMgPSBmYWxzZTsKICB0aGlzLmRpc3JlZ2FyZE5vcm1hbHMgPSBmYWxzZTsKICB0aGlzLnZlcnRpY2VzID0gW107CiAgdGhpcy5jb2xvcnMgPSBbXTsKICB0aGlzLm5vcm1hbHMgPSBbXTsKICB0aGlzLnV2cyA9IFtdOwogIHRoaXMucmF3TWVzaCA9IHsKICAgIG9iamVjdE5hbWU6ICcnLAogICAgZ3JvdXBOYW1lOiAnJywKICAgIGFjdGl2ZU10bE5hbWU6ICcnLAogICAgbXRsbGliTmFtZTogJycsCiAgICAvLyByZXNldCB3aXRoIG5ldyBtZXNoCiAgICBmYWNlVHlwZTogLTEsCiAgICBzdWJHcm91cHM6IFtdLAogICAgc3ViR3JvdXBJblVzZTogbnVsbCwKICAgIHNtb290aGluZ0dyb3VwOiB7CiAgICAgIHNwbGl0TWF0ZXJpYWxzOiBmYWxzZSwKICAgICAgbm9ybWFsaXplZDogLTEsCiAgICAgIHJlYWw6IC0xCiAgICB9LAogICAgY291bnRzOiB7CiAgICAgIGRvdWJsZUluZGljZXNDb3VudDogMCwKICAgICAgZmFjZUNvdW50OiAwLAogICAgICBtdGxDb3VudDogMCwKICAgICAgc21vb3RoaW5nR3JvdXBDb3VudDogMAogICAgfQogIH07CiAgdGhpcy5pbnB1dE9iamVjdENvdW50ID0gMTsKICB0aGlzLm91dHB1dE9iamVjdENvdW50ID0gMTsKICB0aGlzLmdsb2JhbENvdW50cyA9IHsKICAgIHZlcnRpY2VzOiAwLAogICAgZmFjZXM6IDAsCiAgICBkb3VibGVJbmRpY2VzQ291bnQ6IDAsCiAgICBsaW5lQnl0ZTogMCwKICAgIGN1cnJlbnRCeXRlOiAwLAogICAgdG90YWxCeXRlczogMAogIH07Cn07CgpPQkpMb2FkZXIyUGFyc2VyLnByb3RvdHlwZSA9IHsKICBjb25zdHJ1Y3RvcjogT0JKTG9hZGVyMlBhcnNlciwKICBfcmVzZXRSYXdNZXNoOiBmdW5jdGlvbiBfcmVzZXRSYXdNZXNoKCkgewogICAgLy8gZmFjZXMgYXJlIHN0b3JlZCBhY2NvcmRpbmcgY29tYmluZWQgaW5kZXggb2YgZ3JvdXAsIG1hdGVyaWFsIGFuZCBzbW9vdGhpbmdHcm91cCAoMCBvciBub3QpCiAgICB0aGlzLnJhd01lc2guc3ViR3JvdXBzID0gW107CiAgICB0aGlzLnJhd01lc2guc3ViR3JvdXBJblVzZSA9IG51bGw7CiAgICB0aGlzLnJhd01lc2guc21vb3RoaW5nR3JvdXAubm9ybWFsaXplZCA9IC0xOwogICAgdGhpcy5yYXdNZXNoLnNtb290aGluZ0dyb3VwLnJlYWwgPSAtMTsgLy8gdGhpcyBkZWZhdWx0IGluZGV4IGlzIHJlcXVpcmVkIGFzIGl0IGlzIHBvc3NpYmxlIHRvIGRlZmluZSBmYWNlcyB3aXRob3V0ICdnJyBvciAndXNlbXRsJwoKICAgIHRoaXMuX3B1c2hTbW9vdGhpbmdHcm91cCgxKTsKCiAgICB0aGlzLnJhd01lc2guY291bnRzLmRvdWJsZUluZGljZXNDb3VudCA9IDA7CiAgICB0aGlzLnJhd01lc2guY291bnRzLmZhY2VDb3VudCA9IDA7CiAgICB0aGlzLnJhd01lc2guY291bnRzLm10bENvdW50ID0gMDsKICAgIHRoaXMucmF3TWVzaC5jb3VudHMuc21vb3RoaW5nR3JvdXBDb3VudCA9IDA7CiAgfSwKCiAgLyoqCiAgICogVGVsbHMgd2hldGhlciBhIG1hdGVyaWFsIHNoYWxsIGJlIGNyZWF0ZWQgcGVyIHNtb290aGluZyBncm91cC4KICAgKgogICAqIEBwYXJhbSB7Ym9vbGVhbn0gbWF0ZXJpYWxQZXJTbW9vdGhpbmdHcm91cD1mYWxzZQogICAqIEByZXR1cm4ge09CSkxvYWRlcjJQYXJzZXJ9CiAgICovCiAgc2V0TWF0ZXJpYWxQZXJTbW9vdGhpbmdHcm91cDogZnVuY3Rpb24gc2V0TWF0ZXJpYWxQZXJTbW9vdGhpbmdHcm91cChtYXRlcmlhbFBlclNtb290aGluZ0dyb3VwKSB7CiAgICB0aGlzLm1hdGVyaWFsUGVyU21vb3RoaW5nR3JvdXAgPSBtYXRlcmlhbFBlclNtb290aGluZ0dyb3VwID09PSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogVXN1YWxseSAnbycgaXMgbWV0YS1pbmZvcm1hdGlvbiBhbmQgZG9lcyBub3QgcmVzdWx0IGluIGNyZWF0aW9uIG9mIG5ldyBtZXNoZXMsIGJ1dCBtZXNoIGNyZWF0aW9uIG9uIG9jY3VycmVuY2Ugb2YgIm8iIGNhbiBiZSBlbmZvcmNlZC4KICAgKgogICAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlT0FzTWVzaD1mYWxzZQogICAqIEByZXR1cm4ge09CSkxvYWRlcjJQYXJzZXJ9CiAgICovCiAgc2V0VXNlT0FzTWVzaDogZnVuY3Rpb24gc2V0VXNlT0FzTWVzaCh1c2VPQXNNZXNoKSB7CiAgICB0aGlzLnVzZU9Bc01lc2ggPSB1c2VPQXNNZXNoID09PSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogSW5zdHJ1Y3RzIGxvYWRlcnMgdG8gY3JlYXRlIGluZGV4ZWQge0BsaW5rIEJ1ZmZlckdlb21ldHJ5fS4KICAgKgogICAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlSW5kaWNlcz1mYWxzZQogICAqIEByZXR1cm4ge09CSkxvYWRlcjJQYXJzZXJ9CiAgICovCiAgc2V0VXNlSW5kaWNlczogZnVuY3Rpb24gc2V0VXNlSW5kaWNlcyh1c2VJbmRpY2VzKSB7CiAgICB0aGlzLnVzZUluZGljZXMgPSB1c2VJbmRpY2VzID09PSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogVGVsbHMgd2hldGhlciBub3JtYWxzIHNob3VsZCBiZSBjb21wbGV0ZWx5IGRpc3JlZ2FyZGVkIGFuZCByZWdlbmVyYXRlZC4KICAgKgogICAqIEBwYXJhbSB7Ym9vbGVhbn0gZGlzcmVnYXJkTm9ybWFscz1mYWxzZQogICAqIEByZXR1cm4ge09CSkxvYWRlcjJQYXJzZXJ9CiAgICovCiAgc2V0RGlzcmVnYXJkTm9ybWFsczogZnVuY3Rpb24gc2V0RGlzcmVnYXJkTm9ybWFscyhkaXNyZWdhcmROb3JtYWxzKSB7CiAgICB0aGlzLmRpc3JlZ2FyZE5vcm1hbHMgPSBkaXNyZWdhcmROb3JtYWxzID09PSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogQ2xlYXJzIG1hdGVyaWFscyBvYmplY3QgYW5kIHNldHMgdGhlIG5ldyBvbmVzLgogICAqCiAgICogQHBhcmFtIHtPYmplY3R9IG1hdGVyaWFscyBPYmplY3Qgd2l0aCBuYW1lZCBtYXRlcmlhbHMKICAgKi8KICBzZXRNYXRlcmlhbHM6IGZ1bmN0aW9uIHNldE1hdGVyaWFscyhtYXRlcmlhbHMpIHsKICAgIHRoaXMubWF0ZXJpYWxzID0gT2JqZWN0LmFzc2lnbih7fSwgbWF0ZXJpYWxzKTsKICB9LAoKICAvKioKICAgKiBSZWdpc3RlciBhIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIG9uY2UgYW4gYXNzZXQgKG1lc2gvbWF0ZXJpYWwpIGJlY29tZXMgYXZhaWxhYmxlLgogICAqCiAgICogQHBhcmFtIG9uQXNzZXRBdmFpbGFibGUKICAgKiBAcmV0dXJuIHtPQkpMb2FkZXIyUGFyc2VyfQogICAqLwogIHNldENhbGxiYWNrT25Bc3NldEF2YWlsYWJsZTogZnVuY3Rpb24gc2V0Q2FsbGJhY2tPbkFzc2V0QXZhaWxhYmxlKG9uQXNzZXRBdmFpbGFibGUpIHsKICAgIGlmIChvbkFzc2V0QXZhaWxhYmxlICE9PSBudWxsICYmIG9uQXNzZXRBdmFpbGFibGUgIT09IHVuZGVmaW5lZCAmJiBvbkFzc2V0QXZhaWxhYmxlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgdGhpcy5jYWxsYmFja3Mub25Bc3NldEF2YWlsYWJsZSA9IG9uQXNzZXRBdmFpbGFibGU7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogUmVnaXN0ZXIgYSBmdW5jdGlvbiB0aGF0IGlzIHVzZWQgdG8gcmVwb3J0IG92ZXJhbGwgcHJvY2Vzc2luZyBwcm9ncmVzcy4KICAgKgogICAqIEBwYXJhbSB7RnVuY3Rpb259IG9uUHJvZ3Jlc3MKICAgKiBAcmV0dXJuIHtPQkpMb2FkZXIyUGFyc2VyfQogICAqLwogIHNldENhbGxiYWNrT25Qcm9ncmVzczogZnVuY3Rpb24gc2V0Q2FsbGJhY2tPblByb2dyZXNzKG9uUHJvZ3Jlc3MpIHsKICAgIGlmIChvblByb2dyZXNzICE9PSBudWxsICYmIG9uUHJvZ3Jlc3MgIT09IHVuZGVmaW5lZCAmJiBvblByb2dyZXNzIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgdGhpcy5jYWxsYmFja3Mub25Qcm9ncmVzcyA9IG9uUHJvZ3Jlc3M7CiAgICB9CgogICAgcmV0dXJuIHRoaXM7CiAgfSwKCiAgLyoqCiAgICogUmVnaXN0ZXIgYW4gZXJyb3IgaGFuZGxlciBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBpZiBlcnJvcnMgb2NjdXIuIEl0IGNhbiBkZWNpZGUgdG8ganVzdCBsb2cgb3IgdG8gdGhyb3cgYW4gZXhjZXB0aW9uLgogICAqCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25FcnJvcgogICAqIEByZXR1cm4ge09CSkxvYWRlcjJQYXJzZXJ9CiAgICovCiAgc2V0Q2FsbGJhY2tPbkVycm9yOiBmdW5jdGlvbiBzZXRDYWxsYmFja09uRXJyb3Iob25FcnJvcikgewogICAgaWYgKG9uRXJyb3IgIT09IG51bGwgJiYgb25FcnJvciAhPT0gdW5kZWZpbmVkICYmIG9uRXJyb3IgaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICB0aGlzLmNhbGxiYWNrcy5vbkVycm9yID0gb25FcnJvcjsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgKiBSZWdpc3RlciBhIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gcGFyc2luZyB3YXMgY29tcGxldGVkLgogICAqCiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb25Mb2FkCiAgICogQHJldHVybiB7T0JKTG9hZGVyMlBhcnNlcn0KICAgKi8KICBzZXRDYWxsYmFja09uTG9hZDogZnVuY3Rpb24gc2V0Q2FsbGJhY2tPbkxvYWQob25Mb2FkKSB7CiAgICBpZiAob25Mb2FkICE9PSBudWxsICYmIG9uTG9hZCAhPT0gdW5kZWZpbmVkICYmIG9uTG9hZCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgIHRoaXMuY2FsbGJhY2tzLm9uTG9hZCA9IG9uTG9hZDsKICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9LAoKICAvKioKICAgKiBBbm5vdW5jZSBwYXJzZSBwcm9ncmVzcyBmZWVkYmFjayB3aGljaCBpcyBsb2dnZWQgdG8gdGhlIGNvbnNvbGUuCiAgICogQHByaXZhdGUKICAgKgogICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IFRleHR1YWwgZGVzY3JpcHRpb24gb2YgdGhlIGV2ZW50CiAgICovCiAgX29uUHJvZ3Jlc3M6IGZ1bmN0aW9uIF9vblByb2dyZXNzKHRleHQpIHsKICAgIHZhciBtZXNzYWdlID0gdGV4dCA/IHRleHQgOiAnJzsKCiAgICBpZiAodGhpcy5sb2dnaW5nLmVuYWJsZWQgJiYgdGhpcy5sb2dnaW5nLmRlYnVnKSB7CiAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpOwogICAgfQogIH0sCgogIC8qKgogICAqIEFubm91bmNlIGVycm9yIGZlZWRiYWNrIHdoaWNoIGlzIGxvZ2dlZCBhcyBlcnJvciBtZXNzYWdlLgogICAqIEBwcml2YXRlCiAgICoKICAgKiBAcGFyYW0ge1N0cmluZ30gZXJyb3JNZXNzYWdlIFRoZSBldmVudCBjb250YWluaW5nIHRoZSBlcnJvcgogICAqLwogIF9vbkVycm9yOiBmdW5jdGlvbiBfb25FcnJvcihlcnJvck1lc3NhZ2UpIHsKICAgIGlmICh0aGlzLmxvZ2dpbmcuZW5hYmxlZCAmJiB0aGlzLmxvZ2dpbmcuZGVidWcpIHsKICAgICAgY29uc29sZS5lcnJvcihlcnJvck1lc3NhZ2UpOwogICAgfQogIH0sCiAgX29uQXNzZXRBdmFpbGFibGU6IGZ1bmN0aW9uIF9vbkFzc2V0QXZhaWxhYmxlKHBheWxvYWQpIHsKICAgIHZhciBlcnJvck1lc3NhZ2UgPSAnT0JKTG9hZGVyMlBhcnNlciBkb2VzIG5vdCBwcm92aWRlIGltcGxlbWVudGF0aW9uIGZvciBvbkFzc2V0QXZhaWxhYmxlLiBBYm9ydGluZy4uLic7CiAgICB0aGlzLmNhbGxiYWNrcy5vbkVycm9yKGVycm9yTWVzc2FnZSk7CiAgICB0aHJvdyBlcnJvck1lc3NhZ2U7CiAgfSwKICBfb25Mb2FkOiBmdW5jdGlvbiBfb25Mb2FkKG9iamVjdDNkLCBtZXNzYWdlKSB7CiAgICBjb25zb2xlLmxvZygiWW91IHJlYWNoZWQgcGFyc2VyIGRlZmF1bHQgb25Mb2FkIGNhbGxiYWNrOiAiICsgbWVzc2FnZSk7CiAgfSwKCiAgLyoqCiAgICogRW5hYmxlIG9yIGRpc2FibGUgbG9nZ2luZyBpbiBnZW5lcmFsIChleGNlcHQgd2FybiBhbmQgZXJyb3IpLCBwbHVzIGVuYWJsZSBvciBkaXNhYmxlIGRlYnVnIGxvZ2dpbmcuCiAgICoKICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZWQgVHJ1ZSBvciBmYWxzZS4KICAgKiBAcGFyYW0ge2Jvb2xlYW59IGRlYnVnIFRydWUgb3IgZmFsc2UuCiAgICoKICAgKiBAcmV0dXJuIHtPQkpMb2FkZXIyUGFyc2VyfQogICAqLwogIHNldExvZ2dpbmc6IGZ1bmN0aW9uIHNldExvZ2dpbmcoZW5hYmxlZCwgZGVidWcpIHsKICAgIHRoaXMubG9nZ2luZy5lbmFibGVkID0gZW5hYmxlZCA9PT0gdHJ1ZTsKICAgIHRoaXMubG9nZ2luZy5kZWJ1ZyA9IGRlYnVnID09PSB0cnVlOwogICAgcmV0dXJuIHRoaXM7CiAgfSwKICBfY29uZmlndXJlOiBmdW5jdGlvbiBfY29uZmlndXJlKCkgewogICAgdGhpcy5fcHVzaFNtb290aGluZ0dyb3VwKDEpOwoKICAgIGlmICh0aGlzLmxvZ2dpbmcuZW5hYmxlZCkgewogICAgICB2YXIgbWF0S2V5cyA9IE9iamVjdC5rZXlzKHRoaXMubWF0ZXJpYWxzKTsKICAgICAgdmFyIG1hdE5hbWVzID0gbWF0S2V5cy5sZW5ndGggPiAwID8gJ1xuXHRtYXRlcmlhbE5hbWVzOlxuXHRcdC0gJyArIG1hdEtleXMuam9pbignXG5cdFx0LSAnKSA6ICdcblx0bWF0ZXJpYWxOYW1lczogTm9uZSc7CiAgICAgIHZhciBwcmludGVkQ29uZmlnID0gJ09CSkxvYWRlci5QYXJzZXIgY29uZmlndXJhdGlvbjonICsgbWF0TmFtZXMgKyAnXG5cdG1hdGVyaWFsUGVyU21vb3RoaW5nR3JvdXA6ICcgKyB0aGlzLm1hdGVyaWFsUGVyU21vb3RoaW5nR3JvdXAgKyAnXG5cdHVzZU9Bc01lc2g6ICcgKyB0aGlzLnVzZU9Bc01lc2ggKyAnXG5cdHVzZUluZGljZXM6ICcgKyB0aGlzLnVzZUluZGljZXMgKyAnXG5cdGRpc3JlZ2FyZE5vcm1hbHM6ICcgKyB0aGlzLmRpc3JlZ2FyZE5vcm1hbHM7CiAgICAgIHByaW50ZWRDb25maWcgKz0gJ1xuXHRjYWxsYmFja3Mub25Qcm9ncmVzczogJyArIHRoaXMuY2FsbGJhY2tzLm9uUHJvZ3Jlc3MubmFtZTsKICAgICAgcHJpbnRlZENvbmZpZyArPSAnXG5cdGNhbGxiYWNrcy5vbkFzc2V0QXZhaWxhYmxlOiAnICsgdGhpcy5jYWxsYmFja3Mub25Bc3NldEF2YWlsYWJsZS5uYW1lOwogICAgICBwcmludGVkQ29uZmlnICs9ICdcblx0Y2FsbGJhY2tzLm9uRXJyb3I6ICcgKyB0aGlzLmNhbGxiYWNrcy5vbkVycm9yLm5hbWU7CiAgICAgIGNvbnNvbGUuaW5mbyhwcmludGVkQ29uZmlnKTsKICAgIH0KICB9LAoKICAvKioKICAgKiBQYXJzZSB0aGUgcHJvdmlkZWQgYXJyYXlidWZmZXIKICAgKgogICAqIEBwYXJhbSB7VWludDhBcnJheX0gYXJyYXlCdWZmZXIgT0JKIGRhdGEgYXMgVWludDhBcnJheQogICAqLwogIGV4ZWN1dGU6IGZ1bmN0aW9uIGV4ZWN1dGUoYXJyYXlCdWZmZXIpIHsKICAgIGlmICh0aGlzLmxvZ2dpbmcuZW5hYmxlZCkgY29uc29sZS50aW1lKCdPQkpMb2FkZXIyUGFyc2VyLmV4ZWN1dGUnKTsKCiAgICB0aGlzLl9jb25maWd1cmUoKTsKCiAgICB2YXIgYXJyYXlCdWZmZXJWaWV3ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpOwogICAgdGhpcy5jb250ZW50UmVmID0gYXJyYXlCdWZmZXJWaWV3OwogICAgdmFyIGxlbmd0aCA9IGFycmF5QnVmZmVyVmlldy5ieXRlTGVuZ3RoOwogICAgdGhpcy5nbG9iYWxDb3VudHMudG90YWxCeXRlcyA9IGxlbmd0aDsKICAgIHZhciBidWZmZXIgPSBuZXcgQXJyYXkoMTI4KTsKCiAgICBmb3IgKHZhciBjb2RlLCB3b3JkID0gJycsIGJ1ZmZlclBvaW50ZXIgPSAwLCBzbGFzaGVzQ291bnQgPSAwLCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNvZGUgPSBhcnJheUJ1ZmZlclZpZXdbaV07CgogICAgICBzd2l0Y2ggKGNvZGUpIHsKICAgICAgICAvLyBzcGFjZQogICAgICAgIGNhc2UgMzI6CiAgICAgICAgICBpZiAod29yZC5sZW5ndGggPiAwKSBidWZmZXJbYnVmZmVyUG9pbnRlcisrXSA9IHdvcmQ7CiAgICAgICAgICB3b3JkID0gJyc7CiAgICAgICAgICBicmVhazsKICAgICAgICAvLyBzbGFzaAoKICAgICAgICBjYXNlIDQ3OgogICAgICAgICAgaWYgKHdvcmQubGVuZ3RoID4gMCkgYnVmZmVyW2J1ZmZlclBvaW50ZXIrK10gPSB3b3JkOwogICAgICAgICAgc2xhc2hlc0NvdW50Kys7CiAgICAgICAgICB3b3JkID0gJyc7CiAgICAgICAgICBicmVhazsKICAgICAgICAvLyBMRgoKICAgICAgICBjYXNlIDEwOgogICAgICAgICAgaWYgKHdvcmQubGVuZ3RoID4gMCkgYnVmZmVyW2J1ZmZlclBvaW50ZXIrK10gPSB3b3JkOwogICAgICAgICAgd29yZCA9ICcnOwogICAgICAgICAgdGhpcy5nbG9iYWxDb3VudHMubGluZUJ5dGUgPSB0aGlzLmdsb2JhbENvdW50cy5jdXJyZW50Qnl0ZTsKICAgICAgICAgIHRoaXMuZ2xvYmFsQ291bnRzLmN1cnJlbnRCeXRlID0gaTsKCiAgICAgICAgICB0aGlzLl9wcm9jZXNzTGluZShidWZmZXIsIGJ1ZmZlclBvaW50ZXIsIHNsYXNoZXNDb3VudCk7CgogICAgICAgICAgYnVmZmVyUG9pbnRlciA9IDA7CiAgICAgICAgICBzbGFzaGVzQ291bnQgPSAwOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gQ1IKCiAgICAgICAgY2FzZSAxMzoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgd29yZCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLl9maW5hbGl6ZVBhcnNpbmcoKTsKCiAgICBpZiAodGhpcy5sb2dnaW5nLmVuYWJsZWQpIGNvbnNvbGUudGltZUVuZCgnT0JKTG9hZGVyMlBhcnNlci5leGVjdXRlJyk7CiAgfSwKCiAgLyoqCiAgICogUGFyc2UgdGhlIHByb3ZpZGVkIHRleHQKICAgKgogICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IE9CSiBkYXRhIGFzIHN0cmluZwogICAqLwogIGV4ZWN1dGVMZWdhY3k6IGZ1bmN0aW9uIGV4ZWN1dGVMZWdhY3kodGV4dCkgewogICAgaWYgKHRoaXMubG9nZ2luZy5lbmFibGVkKSBjb25zb2xlLnRpbWUoJ09CSkxvYWRlcjJQYXJzZXIuZXhlY3V0ZUxlZ2FjeScpOwoKICAgIHRoaXMuX2NvbmZpZ3VyZSgpOwoKICAgIHRoaXMubGVnYWN5TW9kZSA9IHRydWU7CiAgICB0aGlzLmNvbnRlbnRSZWYgPSB0ZXh0OwogICAgdmFyIGxlbmd0aCA9IHRleHQubGVuZ3RoOwogICAgdGhpcy5nbG9iYWxDb3VudHMudG90YWxCeXRlcyA9IGxlbmd0aDsKICAgIHZhciBidWZmZXIgPSBuZXcgQXJyYXkoMTI4KTsKCiAgICBmb3IgKHZhciBjaGFyLCB3b3JkID0gJycsIGJ1ZmZlclBvaW50ZXIgPSAwLCBzbGFzaGVzQ291bnQgPSAwLCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgIGNoYXIgPSB0ZXh0W2ldOwoKICAgICAgc3dpdGNoIChjaGFyKSB7CiAgICAgICAgY2FzZSAnICc6CiAgICAgICAgICBpZiAod29yZC5sZW5ndGggPiAwKSBidWZmZXJbYnVmZmVyUG9pbnRlcisrXSA9IHdvcmQ7CiAgICAgICAgICB3b3JkID0gJyc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnLyc6CiAgICAgICAgICBpZiAod29yZC5sZW5ndGggPiAwKSBidWZmZXJbYnVmZmVyUG9pbnRlcisrXSA9IHdvcmQ7CiAgICAgICAgICBzbGFzaGVzQ291bnQrKzsKICAgICAgICAgIHdvcmQgPSAnJzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdcbic6CiAgICAgICAgICBpZiAod29yZC5sZW5ndGggPiAwKSBidWZmZXJbYnVmZmVyUG9pbnRlcisrXSA9IHdvcmQ7CiAgICAgICAgICB3b3JkID0gJyc7CiAgICAgICAgICB0aGlzLmdsb2JhbENvdW50cy5saW5lQnl0ZSA9IHRoaXMuZ2xvYmFsQ291bnRzLmN1cnJlbnRCeXRlOwogICAgICAgICAgdGhpcy5nbG9iYWxDb3VudHMuY3VycmVudEJ5dGUgPSBpOwoKICAgICAgICAgIHRoaXMuX3Byb2Nlc3NMaW5lKGJ1ZmZlciwgYnVmZmVyUG9pbnRlciwgc2xhc2hlc0NvdW50KTsKCiAgICAgICAgICBidWZmZXJQb2ludGVyID0gMDsKICAgICAgICAgIHNsYXNoZXNDb3VudCA9IDA7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSAnXHInOgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICB3b3JkICs9IGNoYXI7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLl9maW5hbGl6ZVBhcnNpbmcoKTsKCiAgICBpZiAodGhpcy5sb2dnaW5nLmVuYWJsZWQpIGNvbnNvbGUudGltZUVuZCgnT0JKTG9hZGVyMlBhcnNlci5leGVjdXRlTGVnYWN5Jyk7CiAgfSwKICBfcHJvY2Vzc0xpbmU6IGZ1bmN0aW9uIF9wcm9jZXNzTGluZShidWZmZXIsIGJ1ZmZlclBvaW50ZXIsIHNsYXNoZXNDb3VudCkgewogICAgaWYgKGJ1ZmZlclBvaW50ZXIgPCAxKSByZXR1cm47CgogICAgdmFyIHJlY29uc3RydWN0U3RyaW5nID0gZnVuY3Rpb24gcmVjb25zdHJ1Y3RTdHJpbmcoY29udGVudCwgbGVnYWN5TW9kZSwgc3RhcnQsIHN0b3ApIHsKICAgICAgdmFyIGxpbmUgPSAnJzsKCiAgICAgIGlmIChzdG9wID4gc3RhcnQpIHsKICAgICAgICB2YXIgX2k7CgogICAgICAgIGlmIChsZWdhY3lNb2RlKSB7CiAgICAgICAgICBmb3IgKF9pID0gc3RhcnQ7IF9pIDwgc3RvcDsgX2krKykgewogICAgICAgICAgICBsaW5lICs9IGNvbnRlbnRbX2ldOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBmb3IgKF9pID0gc3RhcnQ7IF9pIDwgc3RvcDsgX2krKykgewogICAgICAgICAgICBsaW5lICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoY29udGVudFtfaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpOwogICAgICB9CgogICAgICByZXR1cm4gbGluZTsKICAgIH07CgogICAgdmFyIGJ1ZmZlckxlbmd0aCwgbGVuZ3RoLCBpLCBsaW5lRGVzaWduYXRpb247CiAgICBsaW5lRGVzaWduYXRpb24gPSBidWZmZXJbMF07CgogICAgc3dpdGNoIChsaW5lRGVzaWduYXRpb24pIHsKICAgICAgY2FzZSAndic6CiAgICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHBhcnNlRmxvYXQoYnVmZmVyWzFdKSk7CiAgICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHBhcnNlRmxvYXQoYnVmZmVyWzJdKSk7CiAgICAgICAgdGhpcy52ZXJ0aWNlcy5wdXNoKHBhcnNlRmxvYXQoYnVmZmVyWzNdKSk7CgogICAgICAgIGlmIChidWZmZXJQb2ludGVyID4gNCkgewogICAgICAgICAgdGhpcy5jb2xvcnMucHVzaChwYXJzZUZsb2F0KGJ1ZmZlcls0XSkpOwogICAgICAgICAgdGhpcy5jb2xvcnMucHVzaChwYXJzZUZsb2F0KGJ1ZmZlcls1XSkpOwogICAgICAgICAgdGhpcy5jb2xvcnMucHVzaChwYXJzZUZsb2F0KGJ1ZmZlcls2XSkpOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICd2dCc6CiAgICAgICAgdGhpcy51dnMucHVzaChwYXJzZUZsb2F0KGJ1ZmZlclsxXSkpOwogICAgICAgIHRoaXMudXZzLnB1c2gocGFyc2VGbG9hdChidWZmZXJbMl0pKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3ZuJzoKICAgICAgICB0aGlzLm5vcm1hbHMucHVzaChwYXJzZUZsb2F0KGJ1ZmZlclsxXSkpOwogICAgICAgIHRoaXMubm9ybWFscy5wdXNoKHBhcnNlRmxvYXQoYnVmZmVyWzJdKSk7CiAgICAgICAgdGhpcy5ub3JtYWxzLnB1c2gocGFyc2VGbG9hdChidWZmZXJbM10pKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2YnOgogICAgICAgIGJ1ZmZlckxlbmd0aCA9IGJ1ZmZlclBvaW50ZXIgLSAxOyAvLyAiZiB2ZXJ0ZXggLi4uIgoKICAgICAgICBpZiAoc2xhc2hlc0NvdW50ID09PSAwKSB7CiAgICAgICAgICB0aGlzLl9jaGVja0ZhY2VUeXBlKDApOwoKICAgICAgICAgIGZvciAoaSA9IDIsIGxlbmd0aCA9IGJ1ZmZlckxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMuX2J1aWxkRmFjZShidWZmZXJbMV0pOwoKICAgICAgICAgICAgdGhpcy5fYnVpbGRGYWNlKGJ1ZmZlcltpXSk7CgogICAgICAgICAgICB0aGlzLl9idWlsZEZhY2UoYnVmZmVyW2kgKyAxXSk7CiAgICAgICAgICB9IC8vICJmIHZlcnRleC91diAuLi4iCgogICAgICAgIH0gZWxzZSBpZiAoYnVmZmVyTGVuZ3RoID09PSBzbGFzaGVzQ291bnQgKiAyKSB7CiAgICAgICAgICB0aGlzLl9jaGVja0ZhY2VUeXBlKDEpOwoKICAgICAgICAgIGZvciAoaSA9IDMsIGxlbmd0aCA9IGJ1ZmZlckxlbmd0aCAtIDI7IGkgPCBsZW5ndGg7IGkgKz0gMikgewogICAgICAgICAgICB0aGlzLl9idWlsZEZhY2UoYnVmZmVyWzFdLCBidWZmZXJbMl0pOwoKICAgICAgICAgICAgdGhpcy5fYnVpbGRGYWNlKGJ1ZmZlcltpXSwgYnVmZmVyW2kgKyAxXSk7CgogICAgICAgICAgICB0aGlzLl9idWlsZEZhY2UoYnVmZmVyW2kgKyAyXSwgYnVmZmVyW2kgKyAzXSk7CiAgICAgICAgICB9IC8vICJmIHZlcnRleC91di9ub3JtYWwgLi4uIgoKICAgICAgICB9IGVsc2UgaWYgKGJ1ZmZlckxlbmd0aCAqIDIgPT09IHNsYXNoZXNDb3VudCAqIDMpIHsKICAgICAgICAgIHRoaXMuX2NoZWNrRmFjZVR5cGUoMik7CgogICAgICAgICAgZm9yIChpID0gNCwgbGVuZ3RoID0gYnVmZmVyTGVuZ3RoIC0gMzsgaSA8IGxlbmd0aDsgaSArPSAzKSB7CiAgICAgICAgICAgIHRoaXMuX2J1aWxkRmFjZShidWZmZXJbMV0sIGJ1ZmZlclsyXSwgYnVmZmVyWzNdKTsKCiAgICAgICAgICAgIHRoaXMuX2J1aWxkRmFjZShidWZmZXJbaV0sIGJ1ZmZlcltpICsgMV0sIGJ1ZmZlcltpICsgMl0pOwoKICAgICAgICAgICAgdGhpcy5fYnVpbGRGYWNlKGJ1ZmZlcltpICsgM10sIGJ1ZmZlcltpICsgNF0sIGJ1ZmZlcltpICsgNV0pOwogICAgICAgICAgfSAvLyAiZiB2ZXJ0ZXgvL25vcm1hbCAuLi4iCgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLl9jaGVja0ZhY2VUeXBlKDMpOwoKICAgICAgICAgIGZvciAoaSA9IDMsIGxlbmd0aCA9IGJ1ZmZlckxlbmd0aCAtIDI7IGkgPCBsZW5ndGg7IGkgKz0gMikgewogICAgICAgICAgICB0aGlzLl9idWlsZEZhY2UoYnVmZmVyWzFdLCB1bmRlZmluZWQsIGJ1ZmZlclsyXSk7CgogICAgICAgICAgICB0aGlzLl9idWlsZEZhY2UoYnVmZmVyW2ldLCB1bmRlZmluZWQsIGJ1ZmZlcltpICsgMV0pOwoKICAgICAgICAgICAgdGhpcy5fYnVpbGRGYWNlKGJ1ZmZlcltpICsgMl0sIHVuZGVmaW5lZCwgYnVmZmVyW2kgKyAzXSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ2wnOgogICAgICBjYXNlICdwJzoKICAgICAgICBidWZmZXJMZW5ndGggPSBidWZmZXJQb2ludGVyIC0gMTsKCiAgICAgICAgaWYgKGJ1ZmZlckxlbmd0aCA9PT0gc2xhc2hlc0NvdW50ICogMikgewogICAgICAgICAgdGhpcy5fY2hlY2tGYWNlVHlwZSg0KTsKCiAgICAgICAgICBmb3IgKGkgPSAxLCBsZW5ndGggPSBidWZmZXJMZW5ndGggKyAxOyBpIDwgbGVuZ3RoOyBpICs9IDIpIHsKICAgICAgICAgICAgdGhpcy5fYnVpbGRGYWNlKGJ1ZmZlcltpXSwgYnVmZmVyW2kgKyAxXSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuX2NoZWNrRmFjZVR5cGUobGluZURlc2lnbmF0aW9uID09PSAnbCcgPyA1IDogNik7CgogICAgICAgICAgZm9yIChpID0gMSwgbGVuZ3RoID0gYnVmZmVyTGVuZ3RoICsgMTsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMuX2J1aWxkRmFjZShidWZmZXJbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdzJzoKICAgICAgICB0aGlzLl9wdXNoU21vb3RoaW5nR3JvdXAoYnVmZmVyWzFdKTsKCiAgICAgICAgYnJlYWs7CgogICAgICBjYXNlICdnJzoKICAgICAgICAvLyAnZycgbGVhZHMgdG8gY3JlYXRpb24gb2YgbWVzaCBpZiB2YWxpZCBkYXRhIChmYWNlcyBkZWNsYXJhdGlvbiB3YXMgZG9uZSBiZWZvcmUpLCBvdGhlcndpc2Ugb25seSBncm91cE5hbWUgZ2V0cyBzZXQKICAgICAgICB0aGlzLl9wcm9jZXNzQ29tcGxldGVkTWVzaCgpOwoKICAgICAgICB0aGlzLnJhd01lc2guZ3JvdXBOYW1lID0gcmVjb25zdHJ1Y3RTdHJpbmcodGhpcy5jb250ZW50UmVmLCB0aGlzLmxlZ2FjeU1vZGUsIHRoaXMuZ2xvYmFsQ291bnRzLmxpbmVCeXRlICsgMiwgdGhpcy5nbG9iYWxDb3VudHMuY3VycmVudEJ5dGUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnbyc6CiAgICAgICAgLy8gJ28nIGlzIG1ldGEtaW5mb3JtYXRpb24gYW5kIHVzdWFsbHkgZG9lcyBub3QgcmVzdWx0IGluIGNyZWF0aW9uIG9mIG5ldyBtZXNoZXMsIGJ1dCBjYW4gYmUgZW5mb3JjZWQgd2l0aCAidXNlT0FzTWVzaCIKICAgICAgICBpZiAodGhpcy51c2VPQXNNZXNoKSB0aGlzLl9wcm9jZXNzQ29tcGxldGVkTWVzaCgpOwogICAgICAgIHRoaXMucmF3TWVzaC5vYmplY3ROYW1lID0gcmVjb25zdHJ1Y3RTdHJpbmcodGhpcy5jb250ZW50UmVmLCB0aGlzLmxlZ2FjeU1vZGUsIHRoaXMuZ2xvYmFsQ291bnRzLmxpbmVCeXRlICsgMiwgdGhpcy5nbG9iYWxDb3VudHMuY3VycmVudEJ5dGUpOwogICAgICAgIGJyZWFrOwoKICAgICAgY2FzZSAnbXRsbGliJzoKICAgICAgICB0aGlzLnJhd01lc2gubXRsbGliTmFtZSA9IHJlY29uc3RydWN0U3RyaW5nKHRoaXMuY29udGVudFJlZiwgdGhpcy5sZWdhY3lNb2RlLCB0aGlzLmdsb2JhbENvdW50cy5saW5lQnl0ZSArIDcsIHRoaXMuZ2xvYmFsQ291bnRzLmN1cnJlbnRCeXRlKTsKICAgICAgICBicmVhazsKCiAgICAgIGNhc2UgJ3VzZW10bCc6CiAgICAgICAgdmFyIG10bE5hbWUgPSByZWNvbnN0cnVjdFN0cmluZyh0aGlzLmNvbnRlbnRSZWYsIHRoaXMubGVnYWN5TW9kZSwgdGhpcy5nbG9iYWxDb3VudHMubGluZUJ5dGUgKyA3LCB0aGlzLmdsb2JhbENvdW50cy5jdXJyZW50Qnl0ZSk7CgogICAgICAgIGlmIChtdGxOYW1lICE9PSAnJyAmJiB0aGlzLnJhd01lc2guYWN0aXZlTXRsTmFtZSAhPT0gbXRsTmFtZSkgewogICAgICAgICAgdGhpcy5yYXdNZXNoLmFjdGl2ZU10bE5hbWUgPSBtdGxOYW1lOwogICAgICAgICAgdGhpcy5yYXdNZXNoLmNvdW50cy5tdGxDb3VudCsrOwoKICAgICAgICAgIHRoaXMuX2NoZWNrU3ViR3JvdXAoKTsKICAgICAgICB9CgogICAgICAgIGJyZWFrOwoKICAgICAgZGVmYXVsdDoKICAgICAgICBicmVhazsKICAgIH0KICB9LAogIF9wdXNoU21vb3RoaW5nR3JvdXA6IGZ1bmN0aW9uIF9wdXNoU21vb3RoaW5nR3JvdXAoc21vb3RoaW5nR3JvdXApIHsKICAgIHZhciBzbW9vdGhpbmdHcm91cEludCA9IHBhcnNlSW50KHNtb290aGluZ0dyb3VwKTsKCiAgICBpZiAoaXNOYU4oc21vb3RoaW5nR3JvdXBJbnQpKSB7CiAgICAgIHNtb290aGluZ0dyb3VwSW50ID0gc21vb3RoaW5nR3JvdXAgPT09ICJvZmYiID8gMCA6IDE7CiAgICB9CgogICAgdmFyIHNtb290aENoZWNrID0gdGhpcy5yYXdNZXNoLnNtb290aGluZ0dyb3VwLm5vcm1hbGl6ZWQ7CiAgICB0aGlzLnJhd01lc2guc21vb3RoaW5nR3JvdXAubm9ybWFsaXplZCA9IHRoaXMucmF3TWVzaC5zbW9vdGhpbmdHcm91cC5zcGxpdE1hdGVyaWFscyA/IHNtb290aGluZ0dyb3VwSW50IDogc21vb3RoaW5nR3JvdXBJbnQgPT09IDAgPyAwIDogMTsKICAgIHRoaXMucmF3TWVzaC5zbW9vdGhpbmdHcm91cC5yZWFsID0gc21vb3RoaW5nR3JvdXBJbnQ7CgogICAgaWYgKHNtb290aENoZWNrICE9PSBzbW9vdGhpbmdHcm91cEludCkgewogICAgICB0aGlzLnJhd01lc2guY291bnRzLnNtb290aGluZ0dyb3VwQ291bnQrKzsKCiAgICAgIHRoaXMuX2NoZWNrU3ViR3JvdXAoKTsKICAgIH0KICB9LAoKICAvKioKICAgKiBFeHBhbmRlZCBmYWNlVHlwZXMgaW5jbHVkZSBhbGwgZm91ciBmYWNlIHR5cGVzLCBib3RoIGxpbmUgdHlwZXMgYW5kIHRoZSBwb2ludCB0eXBlCiAgICogZmFjZVR5cGUgPSAwOiAiZiB2ZXJ0ZXggLi4uIgogICAqIGZhY2VUeXBlID0gMTogImYgdmVydGV4L3V2IC4uLiIKICAgKiBmYWNlVHlwZSA9IDI6ICJmIHZlcnRleC91di9ub3JtYWwgLi4uIgogICAqIGZhY2VUeXBlID0gMzogImYgdmVydGV4Ly9ub3JtYWwgLi4uIgogICAqIGZhY2VUeXBlID0gNDogImwgdmVydGV4L3V2IC4uLiIgb3IgImwgdmVydGV4IC4uLiIKICAgKiBmYWNlVHlwZSA9IDU6ICJsIHZlcnRleCAuLi4iCiAgICogZmFjZVR5cGUgPSA2OiAicCB2ZXJ0ZXggLi4uIgogICAqLwogIF9jaGVja0ZhY2VUeXBlOiBmdW5jdGlvbiBfY2hlY2tGYWNlVHlwZShmYWNlVHlwZSkgewogICAgaWYgKHRoaXMucmF3TWVzaC5mYWNlVHlwZSAhPT0gZmFjZVR5cGUpIHsKICAgICAgdGhpcy5fcHJvY2Vzc0NvbXBsZXRlZE1lc2goKTsKCiAgICAgIHRoaXMucmF3TWVzaC5mYWNlVHlwZSA9IGZhY2VUeXBlOwoKICAgICAgdGhpcy5fY2hlY2tTdWJHcm91cCgpOwogICAgfQogIH0sCiAgX2NoZWNrU3ViR3JvdXA6IGZ1bmN0aW9uIF9jaGVja1N1Ykdyb3VwKCkgewogICAgdmFyIGluZGV4ID0gdGhpcy5yYXdNZXNoLmFjdGl2ZU10bE5hbWUgKyAnfCcgKyB0aGlzLnJhd01lc2guc21vb3RoaW5nR3JvdXAubm9ybWFsaXplZDsKICAgIHRoaXMucmF3TWVzaC5zdWJHcm91cEluVXNlID0gdGhpcy5yYXdNZXNoLnN1Ykdyb3Vwc1tpbmRleF07CgogICAgaWYgKHRoaXMucmF3TWVzaC5zdWJHcm91cEluVXNlID09PSB1bmRlZmluZWQgfHwgdGhpcy5yYXdNZXNoLnN1Ykdyb3VwSW5Vc2UgPT09IG51bGwpIHsKICAgICAgdGhpcy5yYXdNZXNoLnN1Ykdyb3VwSW5Vc2UgPSB7CiAgICAgICAgaW5kZXg6IGluZGV4LAogICAgICAgIG9iamVjdE5hbWU6IHRoaXMucmF3TWVzaC5vYmplY3ROYW1lLAogICAgICAgIGdyb3VwTmFtZTogdGhpcy5yYXdNZXNoLmdyb3VwTmFtZSwKICAgICAgICBtYXRlcmlhbE5hbWU6IHRoaXMucmF3TWVzaC5hY3RpdmVNdGxOYW1lLAogICAgICAgIHNtb290aGluZ0dyb3VwOiB0aGlzLnJhd01lc2guc21vb3RoaW5nR3JvdXAubm9ybWFsaXplZCwKICAgICAgICB2ZXJ0aWNlczogW10sCiAgICAgICAgaW5kZXhNYXBwaW5nc0NvdW50OiAwLAogICAgICAgIGluZGV4TWFwcGluZ3M6IFtdLAogICAgICAgIGluZGljZXM6IFtdLAogICAgICAgIGNvbG9yczogW10sCiAgICAgICAgdXZzOiBbXSwKICAgICAgICBub3JtYWxzOiBbXQogICAgICB9OwogICAgICB0aGlzLnJhd01lc2guc3ViR3JvdXBzW2luZGV4XSA9IHRoaXMucmF3TWVzaC5zdWJHcm91cEluVXNlOwogICAgfQogIH0sCiAgX2J1aWxkRmFjZTogZnVuY3Rpb24gX2J1aWxkRmFjZShmYWNlSW5kZXhWLCBmYWNlSW5kZXhVLCBmYWNlSW5kZXhOKSB7CiAgICB2YXIgc3ViR3JvdXBJblVzZSA9IHRoaXMucmF3TWVzaC5zdWJHcm91cEluVXNlOwogICAgdmFyIHNjb3BlID0gdGhpczsKCiAgICB2YXIgdXBkYXRlU3ViR3JvdXBJblVzZSA9IGZ1bmN0aW9uIHVwZGF0ZVN1Ykdyb3VwSW5Vc2UoKSB7CiAgICAgIHZhciBmYWNlSW5kZXhWaSA9IHBhcnNlSW50KGZhY2VJbmRleFYpOwogICAgICB2YXIgaW5kZXhQb2ludGVyViA9IDMgKiAoZmFjZUluZGV4VmkgPiAwID8gZmFjZUluZGV4VmkgLSAxIDogZmFjZUluZGV4VmkgKyBzY29wZS52ZXJ0aWNlcy5sZW5ndGggLyAzKTsKICAgICAgdmFyIGluZGV4UG9pbnRlckMgPSBzY29wZS5jb2xvcnMubGVuZ3RoID4gMCA/IGluZGV4UG9pbnRlclYgOiBudWxsOwogICAgICB2YXIgdmVydGljZXMgPSBzdWJHcm91cEluVXNlLnZlcnRpY2VzOwogICAgICB2ZXJ0aWNlcy5wdXNoKHNjb3BlLnZlcnRpY2VzW2luZGV4UG9pbnRlclYrK10pOwogICAgICB2ZXJ0aWNlcy5wdXNoKHNjb3BlLnZlcnRpY2VzW2luZGV4UG9pbnRlclYrK10pOwogICAgICB2ZXJ0aWNlcy5wdXNoKHNjb3BlLnZlcnRpY2VzW2luZGV4UG9pbnRlclZdKTsKCiAgICAgIGlmIChpbmRleFBvaW50ZXJDICE9PSBudWxsKSB7CiAgICAgICAgdmFyIGNvbG9ycyA9IHN1Ykdyb3VwSW5Vc2UuY29sb3JzOwogICAgICAgIGNvbG9ycy5wdXNoKHNjb3BlLmNvbG9yc1tpbmRleFBvaW50ZXJDKytdKTsKICAgICAgICBjb2xvcnMucHVzaChzY29wZS5jb2xvcnNbaW5kZXhQb2ludGVyQysrXSk7CiAgICAgICAgY29sb3JzLnB1c2goc2NvcGUuY29sb3JzW2luZGV4UG9pbnRlckNdKTsKICAgICAgfQoKICAgICAgaWYgKGZhY2VJbmRleFUpIHsKICAgICAgICB2YXIgZmFjZUluZGV4VWkgPSBwYXJzZUludChmYWNlSW5kZXhVKTsKICAgICAgICB2YXIgaW5kZXhQb2ludGVyVSA9IDIgKiAoZmFjZUluZGV4VWkgPiAwID8gZmFjZUluZGV4VWkgLSAxIDogZmFjZUluZGV4VWkgKyBzY29wZS51dnMubGVuZ3RoIC8gMik7CiAgICAgICAgdmFyIHV2cyA9IHN1Ykdyb3VwSW5Vc2UudXZzOwogICAgICAgIHV2cy5wdXNoKHNjb3BlLnV2c1tpbmRleFBvaW50ZXJVKytdKTsKICAgICAgICB1dnMucHVzaChzY29wZS51dnNbaW5kZXhQb2ludGVyVV0pOwogICAgICB9CgogICAgICBpZiAoZmFjZUluZGV4TiAmJiAhc2NvcGUuZGlzcmVnYXJkTm9ybWFscykgewogICAgICAgIHZhciBmYWNlSW5kZXhOaSA9IHBhcnNlSW50KGZhY2VJbmRleE4pOwogICAgICAgIHZhciBpbmRleFBvaW50ZXJOID0gMyAqIChmYWNlSW5kZXhOaSA+IDAgPyBmYWNlSW5kZXhOaSAtIDEgOiBmYWNlSW5kZXhOaSArIHNjb3BlLm5vcm1hbHMubGVuZ3RoIC8gMyk7CiAgICAgICAgdmFyIG5vcm1hbHMgPSBzdWJHcm91cEluVXNlLm5vcm1hbHM7CiAgICAgICAgbm9ybWFscy5wdXNoKHNjb3BlLm5vcm1hbHNbaW5kZXhQb2ludGVyTisrXSk7CiAgICAgICAgbm9ybWFscy5wdXNoKHNjb3BlLm5vcm1hbHNbaW5kZXhQb2ludGVyTisrXSk7CiAgICAgICAgbm9ybWFscy5wdXNoKHNjb3BlLm5vcm1hbHNbaW5kZXhQb2ludGVyTl0pOwogICAgICB9CiAgICB9OwoKICAgIGlmICh0aGlzLnVzZUluZGljZXMpIHsKICAgICAgaWYgKHRoaXMuZGlzcmVnYXJkTm9ybWFscykgZmFjZUluZGV4TiA9IHVuZGVmaW5lZDsKICAgICAgdmFyIG1hcHBpbmdOYW1lID0gZmFjZUluZGV4ViArIChmYWNlSW5kZXhVID8gJ18nICsgZmFjZUluZGV4VSA6ICdfbicpICsgKGZhY2VJbmRleE4gPyAnXycgKyBmYWNlSW5kZXhOIDogJ19uJyk7CiAgICAgIHZhciBpbmRpY2VzUG9pbnRlciA9IHN1Ykdyb3VwSW5Vc2UuaW5kZXhNYXBwaW5nc1ttYXBwaW5nTmFtZV07CgogICAgICBpZiAoaW5kaWNlc1BvaW50ZXIgPT09IHVuZGVmaW5lZCB8fCBpbmRpY2VzUG9pbnRlciA9PT0gbnVsbCkgewogICAgICAgIGluZGljZXNQb2ludGVyID0gdGhpcy5yYXdNZXNoLnN1Ykdyb3VwSW5Vc2UudmVydGljZXMubGVuZ3RoIC8gMzsKICAgICAgICB1cGRhdGVTdWJHcm91cEluVXNlKCk7CiAgICAgICAgc3ViR3JvdXBJblVzZS5pbmRleE1hcHBpbmdzW21hcHBpbmdOYW1lXSA9IGluZGljZXNQb2ludGVyOwogICAgICAgIHN1Ykdyb3VwSW5Vc2UuaW5kZXhNYXBwaW5nc0NvdW50Kys7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5yYXdNZXNoLmNvdW50cy5kb3VibGVJbmRpY2VzQ291bnQrKzsKICAgICAgfQoKICAgICAgc3ViR3JvdXBJblVzZS5pbmRpY2VzLnB1c2goaW5kaWNlc1BvaW50ZXIpOwogICAgfSBlbHNlIHsKICAgICAgdXBkYXRlU3ViR3JvdXBJblVzZSgpOwogICAgfQoKICAgIHRoaXMucmF3TWVzaC5jb3VudHMuZmFjZUNvdW50Kys7CiAgfSwKICBfY3JlYXRlUmF3TWVzaFJlcG9ydDogZnVuY3Rpb24gX2NyZWF0ZVJhd01lc2hSZXBvcnQoaW5wdXRPYmplY3RDb3VudCkgewogICAgcmV0dXJuICdJbnB1dCBPYmplY3QgbnVtYmVyOiAnICsgaW5wdXRPYmplY3RDb3VudCArICdcblx0T2JqZWN0IG5hbWU6ICcgKyB0aGlzLnJhd01lc2gub2JqZWN0TmFtZSArICdcblx0R3JvdXAgbmFtZTogJyArIHRoaXMucmF3TWVzaC5ncm91cE5hbWUgKyAnXG5cdE10bGxpYiBuYW1lOiAnICsgdGhpcy5yYXdNZXNoLm10bGxpYk5hbWUgKyAnXG5cdFZlcnRleCBjb3VudDogJyArIHRoaXMudmVydGljZXMubGVuZ3RoIC8gMyArICdcblx0Tm9ybWFsIGNvdW50OiAnICsgdGhpcy5ub3JtYWxzLmxlbmd0aCAvIDMgKyAnXG5cdFVWIGNvdW50OiAnICsgdGhpcy51dnMubGVuZ3RoIC8gMiArICdcblx0U21vb3RoaW5nR3JvdXAgY291bnQ6ICcgKyB0aGlzLnJhd01lc2guY291bnRzLnNtb290aGluZ0dyb3VwQ291bnQgKyAnXG5cdE1hdGVyaWFsIGNvdW50OiAnICsgdGhpcy5yYXdNZXNoLmNvdW50cy5tdGxDb3VudCArICdcblx0UmVhbCBNZXNoT3V0cHV0R3JvdXAgY291bnQ6ICcgKyB0aGlzLnJhd01lc2guc3ViR3JvdXBzLmxlbmd0aDsKICB9LAoKICAvKioKICAgKiBDbGVhciBhbnkgZW1wdHkgc3ViR3JvdXAgYW5kIGNhbGN1bGF0ZSBhYnNvbHV0ZSB2ZXJ0ZXgsIG5vcm1hbCBhbmQgdXYgY291bnRzCiAgICovCiAgX2ZpbmFsaXplUmF3TWVzaDogZnVuY3Rpb24gX2ZpbmFsaXplUmF3TWVzaCgpIHsKICAgIHZhciBtZXNoT3V0cHV0R3JvdXBUZW1wID0gW107CiAgICB2YXIgbWVzaE91dHB1dEdyb3VwOwogICAgdmFyIGFic29sdXRlVmVydGV4Q291bnQgPSAwOwogICAgdmFyIGFic29sdXRlSW5kZXhNYXBwaW5nc0NvdW50ID0gMDsKICAgIHZhciBhYnNvbHV0ZUluZGV4Q291bnQgPSAwOwogICAgdmFyIGFic29sdXRlQ29sb3JDb3VudCA9IDA7CiAgICB2YXIgYWJzb2x1dGVOb3JtYWxDb3VudCA9IDA7CiAgICB2YXIgYWJzb2x1dGVVdkNvdW50ID0gMDsKICAgIHZhciBpbmRpY2VzOwoKICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5yYXdNZXNoLnN1Ykdyb3VwcykgewogICAgICBtZXNoT3V0cHV0R3JvdXAgPSB0aGlzLnJhd01lc2guc3ViR3JvdXBzW25hbWVdOwoKICAgICAgaWYgKG1lc2hPdXRwdXRHcm91cC52ZXJ0aWNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgaW5kaWNlcyA9IG1lc2hPdXRwdXRHcm91cC5pbmRpY2VzOwoKICAgICAgICBpZiAoaW5kaWNlcy5sZW5ndGggPiAwICYmIGFic29sdXRlSW5kZXhNYXBwaW5nc0NvdW50ID4gMCkgewogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpbmRpY2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGluZGljZXNbaV0gPSBpbmRpY2VzW2ldICsgYWJzb2x1dGVJbmRleE1hcHBpbmdzQ291bnQ7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBtZXNoT3V0cHV0R3JvdXBUZW1wLnB1c2gobWVzaE91dHB1dEdyb3VwKTsKICAgICAgICBhYnNvbHV0ZVZlcnRleENvdW50ICs9IG1lc2hPdXRwdXRHcm91cC52ZXJ0aWNlcy5sZW5ndGg7CiAgICAgICAgYWJzb2x1dGVJbmRleE1hcHBpbmdzQ291bnQgKz0gbWVzaE91dHB1dEdyb3VwLmluZGV4TWFwcGluZ3NDb3VudDsKICAgICAgICBhYnNvbHV0ZUluZGV4Q291bnQgKz0gbWVzaE91dHB1dEdyb3VwLmluZGljZXMubGVuZ3RoOwogICAgICAgIGFic29sdXRlQ29sb3JDb3VudCArPSBtZXNoT3V0cHV0R3JvdXAuY29sb3JzLmxlbmd0aDsKICAgICAgICBhYnNvbHV0ZVV2Q291bnQgKz0gbWVzaE91dHB1dEdyb3VwLnV2cy5sZW5ndGg7CiAgICAgICAgYWJzb2x1dGVOb3JtYWxDb3VudCArPSBtZXNoT3V0cHV0R3JvdXAubm9ybWFscy5sZW5ndGg7CiAgICAgIH0KICAgIH0gLy8gZG8gbm90IGNvbnRpbnVlIGlmIG5vIHJlc3VsdAoKCiAgICB2YXIgcmVzdWx0ID0gbnVsbDsKCiAgICBpZiAobWVzaE91dHB1dEdyb3VwVGVtcC5sZW5ndGggPiAwKSB7CiAgICAgIHJlc3VsdCA9IHsKICAgICAgICBuYW1lOiB0aGlzLnJhd01lc2guZ3JvdXBOYW1lICE9PSAnJyA/IHRoaXMucmF3TWVzaC5ncm91cE5hbWUgOiB0aGlzLnJhd01lc2gub2JqZWN0TmFtZSwKICAgICAgICBzdWJHcm91cHM6IG1lc2hPdXRwdXRHcm91cFRlbXAsCiAgICAgICAgYWJzb2x1dGVWZXJ0ZXhDb3VudDogYWJzb2x1dGVWZXJ0ZXhDb3VudCwKICAgICAgICBhYnNvbHV0ZUluZGV4Q291bnQ6IGFic29sdXRlSW5kZXhDb3VudCwKICAgICAgICBhYnNvbHV0ZUNvbG9yQ291bnQ6IGFic29sdXRlQ29sb3JDb3VudCwKICAgICAgICBhYnNvbHV0ZU5vcm1hbENvdW50OiBhYnNvbHV0ZU5vcm1hbENvdW50LAogICAgICAgIGFic29sdXRlVXZDb3VudDogYWJzb2x1dGVVdkNvdW50LAogICAgICAgIGZhY2VDb3VudDogdGhpcy5yYXdNZXNoLmNvdW50cy5mYWNlQ291bnQsCiAgICAgICAgZG91YmxlSW5kaWNlc0NvdW50OiB0aGlzLnJhd01lc2guY291bnRzLmRvdWJsZUluZGljZXNDb3VudAogICAgICB9OwogICAgfQoKICAgIHJldHVybiByZXN1bHQ7CiAgfSwKICBfcHJvY2Vzc0NvbXBsZXRlZE1lc2g6IGZ1bmN0aW9uIF9wcm9jZXNzQ29tcGxldGVkTWVzaCgpIHsKICAgIHZhciByZXN1bHQgPSB0aGlzLl9maW5hbGl6ZVJhd01lc2goKTsKCiAgICB2YXIgaGF2ZU1lc2ggPSByZXN1bHQgIT09IG51bGw7CgogICAgaWYgKGhhdmVNZXNoKSB7CiAgICAgIGlmICh0aGlzLmNvbG9ycy5sZW5ndGggPiAwICYmIHRoaXMuY29sb3JzLmxlbmd0aCAhPT0gdGhpcy52ZXJ0aWNlcy5sZW5ndGgpIHsKICAgICAgICB0aGlzLmNhbGxiYWNrcy5vbkVycm9yKCdWZXJ0ZXggQ29sb3JzIHdlcmUgZGV0ZWN0ZWQsIGJ1dCB2ZXJ0ZXggY291bnQgYW5kIGNvbG9yIGNvdW50IGRvIG5vdCBtYXRjaCEnKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubG9nZ2luZy5lbmFibGVkICYmIHRoaXMubG9nZ2luZy5kZWJ1ZykgY29uc29sZS5kZWJ1Zyh0aGlzLl9jcmVhdGVSYXdNZXNoUmVwb3J0KHRoaXMuaW5wdXRPYmplY3RDb3VudCkpOwogICAgICB0aGlzLmlucHV0T2JqZWN0Q291bnQrKzsKCiAgICAgIHRoaXMuX2J1aWxkTWVzaChyZXN1bHQpOwoKICAgICAgdmFyIHByb2dyZXNzQnl0ZXNQZXJjZW50ID0gdGhpcy5nbG9iYWxDb3VudHMuY3VycmVudEJ5dGUgLyB0aGlzLmdsb2JhbENvdW50cy50b3RhbEJ5dGVzOwoKICAgICAgdGhpcy5fb25Qcm9ncmVzcygnQ29tcGxldGVkIFtvOiAnICsgdGhpcy5yYXdNZXNoLm9iamVjdE5hbWUgKyAnIGc6JyArIHRoaXMucmF3TWVzaC5ncm91cE5hbWUgKyAnJyArICddIFRvdGFsIHByb2dyZXNzOiAnICsgKHByb2dyZXNzQnl0ZXNQZXJjZW50ICogMTAwKS50b0ZpeGVkKDIpICsgJyUnKTsKCiAgICAgIHRoaXMuX3Jlc2V0UmF3TWVzaCgpOwogICAgfQoKICAgIHJldHVybiBoYXZlTWVzaDsKICB9LAoKICAvKioKICAgKiBTdWJHcm91cHMgYXJlIHRyYW5zZm9ybWVkIHRvIHRvbyBpbnRlcm1lZGlhdGUgZm9ybWF0IHRoYXQgaXMgZm9yd2FyZGVkIHRvIHRoZSBNZXNoUmVjZWl2ZXIuCiAgICogSXQgaXMgZW5zdXJlZCB0aGF0IFN1Ykdyb3VwcyBvbmx5IGNvbnRhaW4gb2JqZWN0cyB3aXRoIHZlcnRpY2VzIChubyBuZWVkIHRvIGNoZWNrKS4KICAgKgogICAqIEBwYXJhbSByZXN1bHQKICAgKi8KICBfYnVpbGRNZXNoOiBmdW5jdGlvbiBfYnVpbGRNZXNoKHJlc3VsdCkgewogICAgdmFyIG1lc2hPdXRwdXRHcm91cHMgPSByZXN1bHQuc3ViR3JvdXBzOwogICAgdmFyIHZlcnRleEZBID0gbmV3IEZsb2F0MzJBcnJheShyZXN1bHQuYWJzb2x1dGVWZXJ0ZXhDb3VudCk7CiAgICB0aGlzLmdsb2JhbENvdW50cy52ZXJ0aWNlcyArPSByZXN1bHQuYWJzb2x1dGVWZXJ0ZXhDb3VudCAvIDM7CiAgICB0aGlzLmdsb2JhbENvdW50cy5mYWNlcyArPSByZXN1bHQuZmFjZUNvdW50OwogICAgdGhpcy5nbG9iYWxDb3VudHMuZG91YmxlSW5kaWNlc0NvdW50ICs9IHJlc3VsdC5kb3VibGVJbmRpY2VzQ291bnQ7CiAgICB2YXIgaW5kZXhVQSA9IHJlc3VsdC5hYnNvbHV0ZUluZGV4Q291bnQgPiAwID8gbmV3IFVpbnQzMkFycmF5KHJlc3VsdC5hYnNvbHV0ZUluZGV4Q291bnQpIDogbnVsbDsKICAgIHZhciBjb2xvckZBID0gcmVzdWx0LmFic29sdXRlQ29sb3JDb3VudCA+IDAgPyBuZXcgRmxvYXQzMkFycmF5KHJlc3VsdC5hYnNvbHV0ZUNvbG9yQ291bnQpIDogbnVsbDsKICAgIHZhciBub3JtYWxGQSA9IHJlc3VsdC5hYnNvbHV0ZU5vcm1hbENvdW50ID4gMCA/IG5ldyBGbG9hdDMyQXJyYXkocmVzdWx0LmFic29sdXRlTm9ybWFsQ291bnQpIDogbnVsbDsKICAgIHZhciB1dkZBID0gcmVzdWx0LmFic29sdXRlVXZDb3VudCA+IDAgPyBuZXcgRmxvYXQzMkFycmF5KHJlc3VsdC5hYnNvbHV0ZVV2Q291bnQpIDogbnVsbDsKICAgIHZhciBoYXZlVmVydGV4Q29sb3JzID0gY29sb3JGQSAhPT0gbnVsbDsKICAgIHZhciBtZXNoT3V0cHV0R3JvdXA7CiAgICB2YXIgbWF0ZXJpYWxOYW1lcyA9IFtdOwogICAgdmFyIGNyZWF0ZU11bHRpTWF0ZXJpYWwgPSBtZXNoT3V0cHV0R3JvdXBzLmxlbmd0aCA+IDE7CiAgICB2YXIgbWF0ZXJpYWxJbmRleCA9IDA7CiAgICB2YXIgbWF0ZXJpYWxJbmRleE1hcHBpbmcgPSBbXTsKICAgIHZhciBzZWxlY3RlZE1hdGVyaWFsSW5kZXg7CiAgICB2YXIgbWF0ZXJpYWxHcm91cDsKICAgIHZhciBtYXRlcmlhbEdyb3VwcyA9IFtdOwogICAgdmFyIHZlcnRleEZBT2Zmc2V0ID0gMDsKICAgIHZhciBpbmRleFVBT2Zmc2V0ID0gMDsKICAgIHZhciBjb2xvckZBT2Zmc2V0ID0gMDsKICAgIHZhciBub3JtYWxGQU9mZnNldCA9IDA7CiAgICB2YXIgdXZGQU9mZnNldCA9IDA7CiAgICB2YXIgbWF0ZXJpYWxHcm91cE9mZnNldCA9IDA7CiAgICB2YXIgbWF0ZXJpYWxHcm91cExlbmd0aCA9IDA7CiAgICB2YXIgbWF0ZXJpYWxPcmcsIG1hdGVyaWFsLCBtYXRlcmlhbE5hbWUsIG1hdGVyaWFsTmFtZU9yZzsgLy8gb25seSBvbmUgc3BlY2lmaWMgZmFjZSB0eXBlCgogICAgZm9yICh2YXIgb29kSW5kZXggaW4gbWVzaE91dHB1dEdyb3VwcykgewogICAgICBpZiAoIW1lc2hPdXRwdXRHcm91cHMuaGFzT3duUHJvcGVydHkob29kSW5kZXgpKSBjb250aW51ZTsKICAgICAgbWVzaE91dHB1dEdyb3VwID0gbWVzaE91dHB1dEdyb3Vwc1tvb2RJbmRleF07CiAgICAgIG1hdGVyaWFsTmFtZU9yZyA9IG1lc2hPdXRwdXRHcm91cC5tYXRlcmlhbE5hbWU7CgogICAgICBpZiAodGhpcy5yYXdNZXNoLmZhY2VUeXBlIDwgNCkgewogICAgICAgIG1hdGVyaWFsTmFtZSA9IG1hdGVyaWFsTmFtZU9yZyArIChoYXZlVmVydGV4Q29sb3JzID8gJ192ZXJ0ZXhDb2xvcicgOiAnJykgKyAobWVzaE91dHB1dEdyb3VwLnNtb290aGluZ0dyb3VwID09PSAwID8gJ19mbGF0JyA6ICcnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXRlcmlhbE5hbWUgPSB0aGlzLnJhd01lc2guZmFjZVR5cGUgPT09IDYgPyAnZGVmYXVsdFBvaW50TWF0ZXJpYWwnIDogJ2RlZmF1bHRMaW5lTWF0ZXJpYWwnOwogICAgICB9CgogICAgICBtYXRlcmlhbE9yZyA9IHRoaXMubWF0ZXJpYWxzW21hdGVyaWFsTmFtZU9yZ107CiAgICAgIG1hdGVyaWFsID0gdGhpcy5tYXRlcmlhbHNbbWF0ZXJpYWxOYW1lXTsgLy8gYm90aCBvcmlnaW5hbCBhbmQgZGVyaXZlZCBuYW1lcyBkbyBub3QgbGVhZCB0byBhbiBleGlzdGluZyBtYXRlcmlhbCA9PiBuZWVkIHRvIHVzZSBhIGRlZmF1bHQgbWF0ZXJpYWwKCiAgICAgIGlmICgobWF0ZXJpYWxPcmcgPT09IHVuZGVmaW5lZCB8fCBtYXRlcmlhbE9yZyA9PT0gbnVsbCkgJiYgKG1hdGVyaWFsID09PSB1bmRlZmluZWQgfHwgbWF0ZXJpYWwgPT09IG51bGwpKSB7CiAgICAgICAgbWF0ZXJpYWxOYW1lID0gaGF2ZVZlcnRleENvbG9ycyA/ICdkZWZhdWx0VmVydGV4Q29sb3JNYXRlcmlhbCcgOiAnZGVmYXVsdE1hdGVyaWFsJzsKICAgICAgICBtYXRlcmlhbCA9IHRoaXMubWF0ZXJpYWxzW21hdGVyaWFsTmFtZV07CgogICAgICAgIGlmICh0aGlzLmxvZ2dpbmcuZW5hYmxlZCkgewogICAgICAgICAgY29uc29sZS5pbmZvKCdvYmplY3RfZ3JvdXAgIicgKyBtZXNoT3V0cHV0R3JvdXAub2JqZWN0TmFtZSArICdfJyArIG1lc2hPdXRwdXRHcm91cC5ncm91cE5hbWUgKyAnIiB3YXMgZGVmaW5lZCB3aXRoIHVucmVzb2x2YWJsZSBtYXRlcmlhbCAiJyArIG1hdGVyaWFsTmFtZU9yZyArICciISBBc3NpZ25pbmcgIicgKyBtYXRlcmlhbE5hbWUgKyAnIi4nKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmIChtYXRlcmlhbCA9PT0gdW5kZWZpbmVkIHx8IG1hdGVyaWFsID09PSBudWxsKSB7CiAgICAgICAgdmFyIG1hdGVyaWFsQ2xvbmVJbnN0cnVjdGlvbnMgPSB7CiAgICAgICAgICBtYXRlcmlhbE5hbWVPcmc6IG1hdGVyaWFsTmFtZU9yZywKICAgICAgICAgIG1hdGVyaWFsTmFtZTogbWF0ZXJpYWxOYW1lLAogICAgICAgICAgbWF0ZXJpYWxQcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgIHZlcnRleENvbG9yczogaGF2ZVZlcnRleENvbG9ycyA/IDIgOiAwLAogICAgICAgICAgICBmbGF0U2hhZGluZzogbWVzaE91dHB1dEdyb3VwLnNtb290aGluZ0dyb3VwID09PSAwCiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB2YXIgcGF5bG9hZCA9IHsKICAgICAgICAgIGNtZDogJ2Fzc2V0QXZhaWxhYmxlJywKICAgICAgICAgIHR5cGU6ICdtYXRlcmlhbCcsCiAgICAgICAgICBtYXRlcmlhbHM6IHsKICAgICAgICAgICAgbWF0ZXJpYWxDbG9uZUluc3RydWN0aW9uczogbWF0ZXJpYWxDbG9uZUluc3RydWN0aW9ucwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdGhpcy5jYWxsYmFja3Mub25Bc3NldEF2YWlsYWJsZShwYXlsb2FkKTsgLy8gb25seSBzZXQgbWF0ZXJpYWxzIGlmIHRoZXkgZG9uJ3QgZXhpc3QsIHlldAoKICAgICAgICB2YXIgbWF0Q2hlY2sgPSB0aGlzLm1hdGVyaWFsc1ttYXRlcmlhbE5hbWVdOwoKICAgICAgICBpZiAobWF0Q2hlY2sgPT09IHVuZGVmaW5lZCB8fCBtYXRDaGVjayA9PT0gbnVsbCkgewogICAgICAgICAgdGhpcy5tYXRlcmlhbHNbbWF0ZXJpYWxOYW1lXSA9IG1hdGVyaWFsQ2xvbmVJbnN0cnVjdGlvbnM7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY3JlYXRlTXVsdGlNYXRlcmlhbCkgewogICAgICAgIC8vIHJlLXVzZSBtYXRlcmlhbCBpZiBhbHJlYWR5IHVzZWQgYmVmb3JlLiBSZWR1Y2VzIG1hdGVyaWFscyBhcnJheSBzaXplIGFuZCBlbGltaW5hdGVzIGR1cGxpY2F0ZXMKICAgICAgICBzZWxlY3RlZE1hdGVyaWFsSW5kZXggPSBtYXRlcmlhbEluZGV4TWFwcGluZ1ttYXRlcmlhbE5hbWVdOwoKICAgICAgICBpZiAoIXNlbGVjdGVkTWF0ZXJpYWxJbmRleCkgewogICAgICAgICAgc2VsZWN0ZWRNYXRlcmlhbEluZGV4ID0gbWF0ZXJpYWxJbmRleDsKICAgICAgICAgIG1hdGVyaWFsSW5kZXhNYXBwaW5nW21hdGVyaWFsTmFtZV0gPSBtYXRlcmlhbEluZGV4OwogICAgICAgICAgbWF0ZXJpYWxOYW1lcy5wdXNoKG1hdGVyaWFsTmFtZSk7CiAgICAgICAgICBtYXRlcmlhbEluZGV4Kys7CiAgICAgICAgfQoKICAgICAgICBtYXRlcmlhbEdyb3VwTGVuZ3RoID0gdGhpcy51c2VJbmRpY2VzID8gbWVzaE91dHB1dEdyb3VwLmluZGljZXMubGVuZ3RoIDogbWVzaE91dHB1dEdyb3VwLnZlcnRpY2VzLmxlbmd0aCAvIDM7CiAgICAgICAgbWF0ZXJpYWxHcm91cCA9IHsKICAgICAgICAgIHN0YXJ0OiBtYXRlcmlhbEdyb3VwT2Zmc2V0LAogICAgICAgICAgY291bnQ6IG1hdGVyaWFsR3JvdXBMZW5ndGgsCiAgICAgICAgICBpbmRleDogc2VsZWN0ZWRNYXRlcmlhbEluZGV4CiAgICAgICAgfTsKICAgICAgICBtYXRlcmlhbEdyb3Vwcy5wdXNoKG1hdGVyaWFsR3JvdXApOwogICAgICAgIG1hdGVyaWFsR3JvdXBPZmZzZXQgKz0gbWF0ZXJpYWxHcm91cExlbmd0aDsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXRlcmlhbE5hbWVzLnB1c2gobWF0ZXJpYWxOYW1lKTsKICAgICAgfQoKICAgICAgdmVydGV4RkEuc2V0KG1lc2hPdXRwdXRHcm91cC52ZXJ0aWNlcywgdmVydGV4RkFPZmZzZXQpOwogICAgICB2ZXJ0ZXhGQU9mZnNldCArPSBtZXNoT3V0cHV0R3JvdXAudmVydGljZXMubGVuZ3RoOwoKICAgICAgaWYgKGluZGV4VUEpIHsKICAgICAgICBpbmRleFVBLnNldChtZXNoT3V0cHV0R3JvdXAuaW5kaWNlcywgaW5kZXhVQU9mZnNldCk7CiAgICAgICAgaW5kZXhVQU9mZnNldCArPSBtZXNoT3V0cHV0R3JvdXAuaW5kaWNlcy5sZW5ndGg7CiAgICAgIH0KCiAgICAgIGlmIChjb2xvckZBKSB7CiAgICAgICAgY29sb3JGQS5zZXQobWVzaE91dHB1dEdyb3VwLmNvbG9ycywgY29sb3JGQU9mZnNldCk7CiAgICAgICAgY29sb3JGQU9mZnNldCArPSBtZXNoT3V0cHV0R3JvdXAuY29sb3JzLmxlbmd0aDsKICAgICAgfQoKICAgICAgaWYgKG5vcm1hbEZBKSB7CiAgICAgICAgbm9ybWFsRkEuc2V0KG1lc2hPdXRwdXRHcm91cC5ub3JtYWxzLCBub3JtYWxGQU9mZnNldCk7CiAgICAgICAgbm9ybWFsRkFPZmZzZXQgKz0gbWVzaE91dHB1dEdyb3VwLm5vcm1hbHMubGVuZ3RoOwogICAgICB9CgogICAgICBpZiAodXZGQSkgewogICAgICAgIHV2RkEuc2V0KG1lc2hPdXRwdXRHcm91cC51dnMsIHV2RkFPZmZzZXQpOwogICAgICAgIHV2RkFPZmZzZXQgKz0gbWVzaE91dHB1dEdyb3VwLnV2cy5sZW5ndGg7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmxvZ2dpbmcuZW5hYmxlZCAmJiB0aGlzLmxvZ2dpbmcuZGVidWcpIHsKICAgICAgICB2YXIgbWF0ZXJpYWxJbmRleExpbmUgPSBzZWxlY3RlZE1hdGVyaWFsSW5kZXggPT09IHVuZGVmaW5lZCB8fCBzZWxlY3RlZE1hdGVyaWFsSW5kZXggPT09IG51bGwgPyAnJyA6ICdcblx0XHRtYXRlcmlhbEluZGV4OiAnICsgc2VsZWN0ZWRNYXRlcmlhbEluZGV4OwogICAgICAgIHZhciBjcmVhdGVkUmVwb3J0ID0gJ1x0T3V0cHV0IE9iamVjdCBuby46ICcgKyB0aGlzLm91dHB1dE9iamVjdENvdW50ICsgJ1xuXHRcdGdyb3VwTmFtZTogJyArIG1lc2hPdXRwdXRHcm91cC5ncm91cE5hbWUgKyAnXG5cdFx0SW5kZXg6ICcgKyBtZXNoT3V0cHV0R3JvdXAuaW5kZXggKyAnXG5cdFx0ZmFjZVR5cGU6ICcgKyB0aGlzLnJhd01lc2guZmFjZVR5cGUgKyAnXG5cdFx0bWF0ZXJpYWxOYW1lOiAnICsgbWVzaE91dHB1dEdyb3VwLm1hdGVyaWFsTmFtZSArICdcblx0XHRzbW9vdGhpbmdHcm91cDogJyArIG1lc2hPdXRwdXRHcm91cC5zbW9vdGhpbmdHcm91cCArIG1hdGVyaWFsSW5kZXhMaW5lICsgJ1xuXHRcdG9iamVjdE5hbWU6ICcgKyBtZXNoT3V0cHV0R3JvdXAub2JqZWN0TmFtZSArICdcblx0XHQjdmVydGljZXM6ICcgKyBtZXNoT3V0cHV0R3JvdXAudmVydGljZXMubGVuZ3RoIC8gMyArICdcblx0XHQjaW5kaWNlczogJyArIG1lc2hPdXRwdXRHcm91cC5pbmRpY2VzLmxlbmd0aCArICdcblx0XHQjY29sb3JzOiAnICsgbWVzaE91dHB1dEdyb3VwLmNvbG9ycy5sZW5ndGggLyAzICsgJ1xuXHRcdCN1dnM6ICcgKyBtZXNoT3V0cHV0R3JvdXAudXZzLmxlbmd0aCAvIDIgKyAnXG5cdFx0I25vcm1hbHM6ICcgKyBtZXNoT3V0cHV0R3JvdXAubm9ybWFscy5sZW5ndGggLyAzOwogICAgICAgIGNvbnNvbGUuZGVidWcoY3JlYXRlZFJlcG9ydCk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLm91dHB1dE9iamVjdENvdW50Kys7CiAgICB0aGlzLmNhbGxiYWNrcy5vbkFzc2V0QXZhaWxhYmxlKHsKICAgICAgY21kOiAnYXNzZXRBdmFpbGFibGUnLAogICAgICB0eXBlOiAnbWVzaCcsCiAgICAgIHByb2dyZXNzOiB7CiAgICAgICAgbnVtZXJpY2FsVmFsdWU6IHRoaXMuZ2xvYmFsQ291bnRzLmN1cnJlbnRCeXRlIC8gdGhpcy5nbG9iYWxDb3VudHMudG90YWxCeXRlcwogICAgICB9LAogICAgICBwYXJhbXM6IHsKICAgICAgICBtZXNoTmFtZTogcmVzdWx0Lm5hbWUKICAgICAgfSwKICAgICAgbWF0ZXJpYWxzOiB7CiAgICAgICAgbXVsdGlNYXRlcmlhbDogY3JlYXRlTXVsdGlNYXRlcmlhbCwKICAgICAgICBtYXRlcmlhbE5hbWVzOiBtYXRlcmlhbE5hbWVzLAogICAgICAgIG1hdGVyaWFsR3JvdXBzOiBtYXRlcmlhbEdyb3VwcwogICAgICB9LAogICAgICBidWZmZXJzOiB7CiAgICAgICAgdmVydGljZXM6IHZlcnRleEZBLAogICAgICAgIGluZGljZXM6IGluZGV4VUEsCiAgICAgICAgY29sb3JzOiBjb2xvckZBLAogICAgICAgIG5vcm1hbHM6IG5vcm1hbEZBLAogICAgICAgIHV2czogdXZGQQogICAgICB9LAogICAgICAvLyAwOiBtZXNoLCAxOiBsaW5lLCAyOiBwb2ludAogICAgICBnZW9tZXRyeVR5cGU6IHRoaXMucmF3TWVzaC5mYWNlVHlwZSA8IDQgPyAwIDogdGhpcy5yYXdNZXNoLmZhY2VUeXBlID09PSA2ID8gMiA6IDEKICAgIH0sIFt2ZXJ0ZXhGQS5idWZmZXJdLCBpbmRleFVBICE9PSBudWxsID8gW2luZGV4VUEuYnVmZmVyXSA6IG51bGwsIGNvbG9yRkEgIT09IG51bGwgPyBbY29sb3JGQS5idWZmZXJdIDogbnVsbCwgbm9ybWFsRkEgIT09IG51bGwgPyBbbm9ybWFsRkEuYnVmZmVyXSA6IG51bGwsIHV2RkEgIT09IG51bGwgPyBbdXZGQS5idWZmZXJdIDogbnVsbCk7CiAgfSwKICBfZmluYWxpemVQYXJzaW5nOiBmdW5jdGlvbiBfZmluYWxpemVQYXJzaW5nKCkgewogICAgaWYgKHRoaXMubG9nZ2luZy5lbmFibGVkKSBjb25zb2xlLmluZm8oJ0dsb2JhbCBvdXRwdXQgb2JqZWN0IGNvdW50OiAnICsgdGhpcy5vdXRwdXRPYmplY3RDb3VudCk7CgogICAgaWYgKHRoaXMuX3Byb2Nlc3NDb21wbGV0ZWRNZXNoKCkgJiYgdGhpcy5sb2dnaW5nLmVuYWJsZWQpIHsKICAgICAgdmFyIHBhcnNlckZpbmFsUmVwb3J0ID0gJ092ZXJhbGwgY291bnRzOiAnICsgJ1xuXHRWZXJ0aWNlczogJyArIHRoaXMuZ2xvYmFsQ291bnRzLnZlcnRpY2VzICsgJ1xuXHRGYWNlczogJyArIHRoaXMuZ2xvYmFsQ291bnRzLmZhY2VzICsgJ1xuXHRNdWx0aXBsZSBkZWZpbml0aW9uczogJyArIHRoaXMuZ2xvYmFsQ291bnRzLmRvdWJsZUluZGljZXNDb3VudDsKICAgICAgY29uc29sZS5pbmZvKHBhcnNlckZpbmFsUmVwb3J0KTsKICAgIH0KICB9Cn07CmV4cG9ydCB7IE9CSkxvYWRlcjJQYXJzZXIgfTs="},{"version":3,"sources":["E:/自己的项目/three_test/src/assets/jsm/loaders/obj2/worker/parallel/OBJLoader2Parser.js"],"names":["OBJLoader2Parser","logging","enabled","debug","scope","callbacks","onProgress","text","_onProgress","onAssetAvailable","payload","_onAssetAvailable","onError","errorMessage","_onError","onLoad","object3d","message","_onLoad","contentRef","legacyMode","materials","materialPerSmoothingGroup","useOAsMesh","useIndices","disregardNormals","vertices","colors","normals","uvs","rawMesh","objectName","groupName","activeMtlName","mtllibName","faceType","subGroups","subGroupInUse","smoothingGroup","splitMaterials","normalized","real","counts","doubleIndicesCount","faceCount","mtlCount","smoothingGroupCount","inputObjectCount","outputObjectCount","globalCounts","faces","lineByte","currentByte","totalBytes","prototype","constructor","_resetRawMesh","_pushSmoothingGroup","setMaterialPerSmoothingGroup","setUseOAsMesh","setUseIndices","setDisregardNormals","setMaterials","Object","assign","setCallbackOnAssetAvailable","undefined","Function","setCallbackOnProgress","setCallbackOnError","setCallbackOnLoad","console","log","error","setLogging","_configure","matKeys","keys","matNames","length","join","printedConfig","name","info","execute","arrayBuffer","time","arrayBufferView","Uint8Array","byteLength","buffer","Array","code","word","bufferPointer","slashesCount","i","_processLine","String","fromCharCode","_finalizeParsing","timeEnd","executeLegacy","char","reconstructString","content","start","stop","line","trim","bufferLength","lineDesignation","push","parseFloat","_checkFaceType","_buildFace","_processCompletedMesh","mtlName","_checkSubGroup","smoothingGroupInt","parseInt","isNaN","smoothCheck","index","materialName","indexMappingsCount","indexMappings","indices","faceIndexV","faceIndexU","faceIndexN","updateSubGroupInUse","faceIndexVi","indexPointerV","indexPointerC","faceIndexUi","indexPointerU","faceIndexNi","indexPointerN","mappingName","indicesPointer","_createRawMeshReport","_finalizeRawMesh","meshOutputGroupTemp","meshOutputGroup","absoluteVertexCount","absoluteIndexMappingsCount","absoluteIndexCount","absoluteColorCount","absoluteNormalCount","absoluteUvCount","result","haveMesh","_buildMesh","progressBytesPercent","toFixed","meshOutputGroups","vertexFA","Float32Array","indexUA","Uint32Array","colorFA","normalFA","uvFA","haveVertexColors","materialNames","createMultiMaterial","materialIndex","materialIndexMapping","selectedMaterialIndex","materialGroup","materialGroups","vertexFAOffset","indexUAOffset","colorFAOffset","normalFAOffset","uvFAOffset","materialGroupOffset","materialGroupLength","materialOrg","material","materialNameOrg","oodIndex","hasOwnProperty","materialCloneInstructions","materialProperties","vertexColors","flatShading","cmd","type","matCheck","count","set","materialIndexLine","createdReport","progress","numericalValue","params","meshName","multiMaterial","buffers","geometryType","parserFinalReport"],"mappings":"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","sourcesContent":["/**\n * @author Kai Salmen / https://kaisalmen.de\n * Development repository: https://github.com/kaisalmen/WWOBJLoader\n */\n\n/**\n * Parse OBJ data either from ArrayBuffer or string\n */\nconst OBJLoader2Parser = function () {\n\n\tthis.logging = {\n\t\tenabled: false,\n\t\tdebug: false\n\t};\n\n\tlet scope = this;\n\tthis.callbacks = {\n\t\tonProgress: function ( text ) {\n\n\t\t\tscope._onProgress( text );\n\n\t\t},\n\t\tonAssetAvailable: function ( payload ) {\n\n\t\t\tscope._onAssetAvailable( payload );\n\n\t\t},\n\t\tonError: function ( errorMessage ) {\n\n\t\t\tscope._onError( errorMessage );\n\n\t\t},\n\t\tonLoad: function ( object3d, message ) {\n\n\t\t\tscope._onLoad( object3d, message );\n\n\t\t},\n\t};\n\tthis.contentRef = null;\n\tthis.legacyMode = false;\n\n\tthis.materials = {};\n\tthis.materialPerSmoothingGroup = false;\n\tthis.useOAsMesh = false;\n\tthis.useIndices = false;\n\tthis.disregardNormals = false;\n\n\tthis.vertices = [];\n\tthis.colors = [];\n\tthis.normals = [];\n\tthis.uvs = [];\n\n\tthis.rawMesh = {\n\t\tobjectName: '',\n\t\tgroupName: '',\n\t\tactiveMtlName: '',\n\t\tmtllibName: '',\n\n\t\t// reset with new mesh\n\t\tfaceType: - 1,\n\t\tsubGroups: [],\n\t\tsubGroupInUse: null,\n\t\tsmoothingGroup: {\n\t\t\tsplitMaterials: false,\n\t\t\tnormalized: - 1,\n\t\t\treal: - 1\n\t\t},\n\t\tcounts: {\n\t\t\tdoubleIndicesCount: 0,\n\t\t\tfaceCount: 0,\n\t\t\tmtlCount: 0,\n\t\t\tsmoothingGroupCount: 0\n\t\t}\n\t};\n\n\tthis.inputObjectCount = 1;\n\tthis.outputObjectCount = 1;\n\tthis.globalCounts = {\n\t\tvertices: 0,\n\t\tfaces: 0,\n\t\tdoubleIndicesCount: 0,\n\t\tlineByte: 0,\n\t\tcurrentByte: 0,\n\t\ttotalBytes: 0\n\t};\n\n};\n\nOBJLoader2Parser.prototype = {\n\n\tconstructor: OBJLoader2Parser,\n\n\t_resetRawMesh: function () {\n\n\t\t// faces are stored according combined index of group, material and smoothingGroup (0 or not)\n\t\tthis.rawMesh.subGroups = [];\n\t\tthis.rawMesh.subGroupInUse = null;\n\t\tthis.rawMesh.smoothingGroup.normalized = - 1;\n\t\tthis.rawMesh.smoothingGroup.real = - 1;\n\n\t\t// this default index is required as it is possible to define faces without 'g' or 'usemtl'\n\t\tthis._pushSmoothingGroup( 1 );\n\n\t\tthis.rawMesh.counts.doubleIndicesCount = 0;\n\t\tthis.rawMesh.counts.faceCount = 0;\n\t\tthis.rawMesh.counts.mtlCount = 0;\n\t\tthis.rawMesh.counts.smoothingGroupCount = 0;\n\n\t},\n\n\t/**\n\t * Tells whether a material shall be created per smoothing group.\n\t *\n\t * @param {boolean} materialPerSmoothingGroup=false\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetMaterialPerSmoothingGroup: function ( materialPerSmoothingGroup ) {\n\n\t\tthis.materialPerSmoothingGroup = materialPerSmoothingGroup === true;\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Usually 'o' is meta-information and does not result in creation of new meshes, but mesh creation on occurrence of \"o\" can be enforced.\n\t *\n\t * @param {boolean} useOAsMesh=false\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetUseOAsMesh: function ( useOAsMesh ) {\n\n\t\tthis.useOAsMesh = useOAsMesh === true;\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Instructs loaders to create indexed {@link BufferGeometry}.\n\t *\n\t * @param {boolean} useIndices=false\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetUseIndices: function ( useIndices ) {\n\n\t\tthis.useIndices = useIndices === true;\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Tells whether normals should be completely disregarded and regenerated.\n\t *\n\t * @param {boolean} disregardNormals=false\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetDisregardNormals: function ( disregardNormals ) {\n\n\t\tthis.disregardNormals = disregardNormals === true;\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Clears materials object and sets the new ones.\n\t *\n\t * @param {Object} materials Object with named materials\n\t */\n\tsetMaterials: function ( materials ) {\n\n \t\tthis.materials = Object.assign( {}, materials );\n\n\t},\n\n\t/**\n\t * Register a function that is called once an asset (mesh/material) becomes available.\n\t *\n\t * @param onAssetAvailable\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetCallbackOnAssetAvailable: function ( onAssetAvailable ) {\n\n\t\tif ( onAssetAvailable !== null && onAssetAvailable !== undefined && onAssetAvailable instanceof Function ) {\n\n\t\t\tthis.callbacks.onAssetAvailable = onAssetAvailable;\n\n\t\t}\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Register a function that is used to report overall processing progress.\n\t *\n\t * @param {Function} onProgress\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetCallbackOnProgress: function ( onProgress ) {\n\n\t\tif ( onProgress !== null && onProgress !== undefined && onProgress instanceof Function ) {\n\n\t\t\tthis.callbacks.onProgress = onProgress;\n\n\t\t}\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Register an error handler function that is called if errors occur. It can decide to just log or to throw an exception.\n\t *\n\t * @param {Function} onError\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetCallbackOnError: function ( onError ) {\n\n\t\tif ( onError !== null && onError !== undefined && onError instanceof Function ) {\n\n\t\t\tthis.callbacks.onError = onError;\n\n\t\t}\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Register a function that is called when parsing was completed.\n\t *\n\t * @param {Function} onLoad\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetCallbackOnLoad: function ( onLoad ) {\n\n\t\tif ( onLoad !== null && onLoad !== undefined && onLoad instanceof Function ) {\n\n\t\t\tthis.callbacks.onLoad = onLoad;\n\n\t\t}\n\t\treturn this;\n\n\t},\n\n\t/**\n\t * Announce parse progress feedback which is logged to the console.\n\t * @private\n\t *\n\t * @param {string} text Textual description of the event\n\t */\n\t_onProgress: function ( text ) {\n\n\t\tlet message = text ? text : '';\n\t\tif ( this.logging.enabled && this.logging.debug ) {\n\n\t\t\tconsole.log( message );\n\n\t\t}\n\n\t},\n\n\t/**\n\t * Announce error feedback which is logged as error message.\n\t * @private\n\t *\n\t * @param {String} errorMessage The event containing the error\n\t */\n\t_onError: function ( errorMessage ) {\n\n\t\tif ( this.logging.enabled && this.logging.debug ) {\n\n\t\t\tconsole.error( errorMessage );\n\n\t\t}\n\n\t},\n\n\t_onAssetAvailable: function ( payload ) {\n\n\t\tlet errorMessage = 'OBJLoader2Parser does not provide implementation for onAssetAvailable. Aborting...';\n\t\tthis.callbacks.onError( errorMessage );\n\t\tthrow errorMessage;\n\n\t},\n\n\t_onLoad: function ( object3d, message ) {\n\n\t\tconsole.log( \"You reached parser default onLoad callback: \" + message );\n\n\t},\n\n\t/**\n\t * Enable or disable logging in general (except warn and error), plus enable or disable debug logging.\n\t *\n\t * @param {boolean} enabled True or false.\n\t * @param {boolean} debug True or false.\n\t *\n\t * @return {OBJLoader2Parser}\n\t */\n\tsetLogging: function ( enabled, debug ) {\n\n\t\tthis.logging.enabled = enabled === true;\n\t\tthis.logging.debug = debug === true;\n\t\treturn this;\n\n\t},\n\n\t_configure: function () {\n\n\t\tthis._pushSmoothingGroup( 1 );\n\t\tif ( this.logging.enabled ) {\n\n\t\t\tlet matKeys = Object.keys( this.materials );\n\t\t\tlet matNames = ( matKeys.length > 0 ) ? '\\n\\tmaterialNames:\\n\\t\\t- ' + matKeys.join( '\\n\\t\\t- ' ) : '\\n\\tmaterialNames: None';\n\t\t\tlet printedConfig = 'OBJLoader.Parser configuration:'\n\t\t\t\t+ matNames\n\t\t\t\t+ '\\n\\tmaterialPerSmoothingGroup: ' + this.materialPerSmoothingGroup\n\t\t\t\t+ '\\n\\tuseOAsMesh: ' + this.useOAsMesh\n\t\t\t\t+ '\\n\\tuseIndices: ' + this.useIndices\n\t\t\t\t+ '\\n\\tdisregardNormals: ' + this.disregardNormals;\n\t\t\tprintedConfig += '\\n\\tcallbacks.onProgress: ' + this.callbacks.onProgress.name;\n\t\t\tprintedConfig += '\\n\\tcallbacks.onAssetAvailable: ' + this.callbacks.onAssetAvailable.name;\n\t\t\tprintedConfig += '\\n\\tcallbacks.onError: ' + this.callbacks.onError.name;\n\t\t\tconsole.info( printedConfig );\n\n\t\t}\n\n\t},\n\n\t/**\n\t * Parse the provided arraybuffer\n\t *\n\t * @param {Uint8Array} arrayBuffer OBJ data as Uint8Array\n\t */\n\texecute: function ( arrayBuffer ) {\n\n\t\tif ( this.logging.enabled ) console.time( 'OBJLoader2Parser.execute' );\n\t\tthis._configure();\n\n\t\tlet arrayBufferView = new Uint8Array( arrayBuffer );\n\t\tthis.contentRef = arrayBufferView;\n\t\tlet length = arrayBufferView.byteLength;\n\t\tthis.globalCounts.totalBytes = length;\n\t\tlet buffer = new Array( 128 );\n\n\t\tfor ( let code, word = '', bufferPointer = 0, slashesCount = 0, i = 0; i < length; i ++ ) {\n\n\t\t\tcode = arrayBufferView[ i ];\n\t\t\tswitch ( code ) {\n\n\t\t\t\t// space\n\t\t\t\tcase 32:\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tword = '';\n\t\t\t\t\tbreak;\n\t\t\t\t// slash\n\t\t\t\tcase 47:\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tslashesCount ++;\n\t\t\t\t\tword = '';\n\t\t\t\t\tbreak;\n\n\t\t\t\t// LF\n\t\t\t\tcase 10:\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tword = '';\n\t\t\t\t\tthis.globalCounts.lineByte = this.globalCounts.currentByte;\n\t\t\t\t\tthis.globalCounts.currentByte = i;\n\t\t\t\t\tthis._processLine( buffer, bufferPointer, slashesCount );\n\t\t\t\t\tbufferPointer = 0;\n\t\t\t\t\tslashesCount = 0;\n\t\t\t\t\tbreak;\n\n\t\t\t\t// CR\n\t\t\t\tcase 13:\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tword += String.fromCharCode( code );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\t\tthis._finalizeParsing();\n\t\tif ( this.logging.enabled ) console.timeEnd( 'OBJLoader2Parser.execute' );\n\n\t},\n\n\t/**\n\t * Parse the provided text\n\t *\n\t * @param {string} text OBJ data as string\n\t */\n\texecuteLegacy: function ( text ) {\n\n\t\tif ( this.logging.enabled ) console.time( 'OBJLoader2Parser.executeLegacy' );\n\t\tthis._configure();\n\t\tthis.legacyMode = true;\n\t\tthis.contentRef = text;\n\t\tlet length = text.length;\n\t\tthis.globalCounts.totalBytes = length;\n\t\tlet buffer = new Array( 128 );\n\n\t\tfor ( let char, word = '', bufferPointer = 0, slashesCount = 0, i = 0; i < length; i ++ ) {\n\n\t\t\tchar = text[ i ];\n\t\t\tswitch ( char ) {\n\n\t\t\t\tcase ' ':\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tword = '';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '/':\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tslashesCount ++;\n\t\t\t\t\tword = '';\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '\\n':\n\t\t\t\t\tif ( word.length > 0 ) buffer[ bufferPointer ++ ] = word;\n\t\t\t\t\tword = '';\n\t\t\t\t\tthis.globalCounts.lineByte = this.globalCounts.currentByte;\n\t\t\t\t\tthis.globalCounts.currentByte = i;\n\t\t\t\t\tthis._processLine( buffer, bufferPointer, slashesCount );\n\t\t\t\t\tbufferPointer = 0;\n\t\t\t\t\tslashesCount = 0;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase '\\r':\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tword += char;\n\n\t\t\t}\n\n\t\t}\n\t\tthis._finalizeParsing();\n\t\tif ( this.logging.enabled ) console.timeEnd( 'OBJLoader2Parser.executeLegacy' );\n\n\t},\n\n\t_processLine: function ( buffer, bufferPointer, slashesCount ) {\n\n\t\tif ( bufferPointer < 1 ) return;\n\n\t\tlet reconstructString = function ( content, legacyMode, start, stop ) {\n\n\t\t\tlet line = '';\n\t\t\tif ( stop > start ) {\n\n\t\t\t\tlet i;\n\t\t\t\tif ( legacyMode ) {\n\n\t\t\t\t\tfor ( i = start; i < stop; i ++ ) line += content[ i ];\n\n\t\t\t\t} else {\n\n\n\t\t\t\t\tfor ( i = start; i < stop; i ++ ) line += String.fromCharCode( content[ i ] );\n\n\t\t\t\t}\n\t\t\t\tline = line.trim();\n\n\t\t\t}\n\t\t\treturn line;\n\n\t\t};\n\n\t\tlet bufferLength, length, i, lineDesignation;\n\t\tlineDesignation = buffer[ 0 ];\n\t\tswitch ( lineDesignation ) {\n\n\t\t\tcase 'v':\n\t\t\t\tthis.vertices.push( parseFloat( buffer[ 1 ] ) );\n\t\t\t\tthis.vertices.push( parseFloat( buffer[ 2 ] ) );\n\t\t\t\tthis.vertices.push( parseFloat( buffer[ 3 ] ) );\n\t\t\t\tif ( bufferPointer > 4 ) {\n\n\t\t\t\t\tthis.colors.push( parseFloat( buffer[ 4 ] ) );\n\t\t\t\t\tthis.colors.push( parseFloat( buffer[ 5 ] ) );\n\t\t\t\t\tthis.colors.push( parseFloat( buffer[ 6 ] ) );\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'vt':\n\t\t\t\tthis.uvs.push( parseFloat( buffer[ 1 ] ) );\n\t\t\t\tthis.uvs.push( parseFloat( buffer[ 2 ] ) );\n\t\t\t\tbreak;\n\n\t\t\tcase 'vn':\n\t\t\t\tthis.normals.push( parseFloat( buffer[ 1 ] ) );\n\t\t\t\tthis.normals.push( parseFloat( buffer[ 2 ] ) );\n\t\t\t\tthis.normals.push( parseFloat( buffer[ 3 ] ) );\n\t\t\t\tbreak;\n\n\t\t\tcase 'f':\n\t\t\t\tbufferLength = bufferPointer - 1;\n\n\t\t\t\t// \"f vertex ...\"\n\t\t\t\tif ( slashesCount === 0 ) {\n\n\t\t\t\t\tthis._checkFaceType( 0 );\n\t\t\t\t\tfor ( i = 2, length = bufferLength; i < length; i ++ ) {\n\n\t\t\t\t\t\tthis._buildFace( buffer[ 1 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i + 1 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// \"f vertex/uv ...\"\n\n\t\t\t\t} else if ( bufferLength === slashesCount * 2 ) {\n\n\t\t\t\t\tthis._checkFaceType( 1 );\n\t\t\t\t\tfor ( i = 3, length = bufferLength - 2; i < length; i += 2 ) {\n\n\t\t\t\t\t\tthis._buildFace( buffer[ 1 ], buffer[ 2 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i ], buffer[ i + 1 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i + 2 ], buffer[ i + 3 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// \"f vertex/uv/normal ...\"\n\n\t\t\t\t} else if ( bufferLength * 2 === slashesCount * 3 ) {\n\n\t\t\t\t\tthis._checkFaceType( 2 );\n\t\t\t\t\tfor ( i = 4, length = bufferLength - 3; i < length; i += 3 ) {\n\n\t\t\t\t\t\tthis._buildFace( buffer[ 1 ], buffer[ 2 ], buffer[ 3 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i ], buffer[ i + 1 ], buffer[ i + 2 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i + 3 ], buffer[ i + 4 ], buffer[ i + 5 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// \"f vertex//normal ...\"\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._checkFaceType( 3 );\n\t\t\t\t\tfor ( i = 3, length = bufferLength - 2; i < length; i += 2 ) {\n\n\t\t\t\t\t\tthis._buildFace( buffer[ 1 ], undefined, buffer[ 2 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i ], undefined, buffer[ i + 1 ] );\n\t\t\t\t\t\tthis._buildFace( buffer[ i + 2 ], undefined, buffer[ i + 3 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'l':\n\t\t\tcase 'p':\n\t\t\t\tbufferLength = bufferPointer - 1;\n\t\t\t\tif ( bufferLength === slashesCount * 2 ) {\n\n\t\t\t\t\tthis._checkFaceType( 4 );\n\t\t\t\t\tfor ( i = 1, length = bufferLength + 1; i < length; i += 2 ) this._buildFace( buffer[ i ], buffer[ i + 1 ] );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthis._checkFaceType( ( lineDesignation === 'l' ) ? 5 : 6 );\n\t\t\t\t\tfor ( i = 1, length = bufferLength + 1; i < length; i ++ ) this._buildFace( buffer[ i ] );\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 's':\n\t\t\t\tthis._pushSmoothingGroup( buffer[ 1 ] );\n\t\t\t\tbreak;\n\n\t\t\tcase 'g':\n\t\t\t\t// 'g' leads to creation of mesh if valid data (faces declaration was done before), otherwise only groupName gets set\n\t\t\t\tthis._processCompletedMesh();\n\t\t\t\tthis.rawMesh.groupName = reconstructString( this.contentRef, this.legacyMode, this.globalCounts.lineByte + 2, this.globalCounts.currentByte );\n\t\t\t\tbreak;\n\n\t\t\tcase 'o':\n\t\t\t\t// 'o' is meta-information and usually does not result in creation of new meshes, but can be enforced with \"useOAsMesh\"\n\t\t\t\tif ( this.useOAsMesh ) this._processCompletedMesh();\n\t\t\t\tthis.rawMesh.objectName = reconstructString( this.contentRef, this.legacyMode, this.globalCounts.lineByte + 2, this.globalCounts.currentByte );\n\t\t\t\tbreak;\n\n\t\t\tcase 'mtllib':\n\t\t\t\tthis.rawMesh.mtllibName = reconstructString( this.contentRef, this.legacyMode, this.globalCounts.lineByte + 7, this.globalCounts.currentByte );\n\t\t\t\tbreak;\n\n\t\t\tcase 'usemtl':\n\t\t\t\tlet mtlName = reconstructString( this.contentRef, this.legacyMode, this.globalCounts.lineByte + 7, this.globalCounts.currentByte );\n\t\t\t\tif ( mtlName !== '' && this.rawMesh.activeMtlName !== mtlName ) {\n\n\t\t\t\t\tthis.rawMesh.activeMtlName = mtlName;\n\t\t\t\t\tthis.rawMesh.counts.mtlCount ++;\n\t\t\t\t\tthis._checkSubGroup();\n\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\n\t\t}\n\n\t},\n\n\t_pushSmoothingGroup: function ( smoothingGroup ) {\n\n\t\tlet smoothingGroupInt = parseInt( smoothingGroup );\n\t\tif ( isNaN( smoothingGroupInt ) ) {\n\n\t\t\tsmoothingGroupInt = smoothingGroup === \"off\" ? 0 : 1;\n\n\t\t}\n\n\t\tlet smoothCheck = this.rawMesh.smoothingGroup.normalized;\n\t\tthis.rawMesh.smoothingGroup.normalized = this.rawMesh.smoothingGroup.splitMaterials ? smoothingGroupInt : ( smoothingGroupInt === 0 ) ? 0 : 1;\n\t\tthis.rawMesh.smoothingGroup.real = smoothingGroupInt;\n\n\t\tif ( smoothCheck !== smoothingGroupInt ) {\n\n\t\t\tthis.rawMesh.counts.smoothingGroupCount ++;\n\t\t\tthis._checkSubGroup();\n\n\t\t}\n\n\t},\n\n\t/**\n\t * Expanded faceTypes include all four face types, both line types and the point type\n\t * faceType = 0: \"f vertex ...\"\n\t * faceType = 1: \"f vertex/uv ...\"\n\t * faceType = 2: \"f vertex/uv/normal ...\"\n\t * faceType = 3: \"f vertex//normal ...\"\n\t * faceType = 4: \"l vertex/uv ...\" or \"l vertex ...\"\n\t * faceType = 5: \"l vertex ...\"\n\t * faceType = 6: \"p vertex ...\"\n\t */\n\t_checkFaceType: function ( faceType ) {\n\n\t\tif ( this.rawMesh.faceType !== faceType ) {\n\n\t\t\tthis._processCompletedMesh();\n\t\t\tthis.rawMesh.faceType = faceType;\n\t\t\tthis._checkSubGroup();\n\n\t\t}\n\n\t},\n\n\t_checkSubGroup: function () {\n\n\t\tlet index = this.rawMesh.activeMtlName + '|' + this.rawMesh.smoothingGroup.normalized;\n\t\tthis.rawMesh.subGroupInUse = this.rawMesh.subGroups[ index ];\n\n\t\tif ( this.rawMesh.subGroupInUse === undefined || this.rawMesh.subGroupInUse === null ) {\n\n\t\t\tthis.rawMesh.subGroupInUse = {\n\t\t\t\tindex: index,\n\t\t\t\tobjectName: this.rawMesh.objectName,\n\t\t\t\tgroupName: this.rawMesh.groupName,\n\t\t\t\tmaterialName: this.rawMesh.activeMtlName,\n\t\t\t\tsmoothingGroup: this.rawMesh.smoothingGroup.normalized,\n\t\t\t\tvertices: [],\n\t\t\t\tindexMappingsCount: 0,\n\t\t\t\tindexMappings: [],\n\t\t\t\tindices: [],\n\t\t\t\tcolors: [],\n\t\t\t\tuvs: [],\n\t\t\t\tnormals: []\n\t\t\t};\n\t\t\tthis.rawMesh.subGroups[ index ] = this.rawMesh.subGroupInUse;\n\n\t\t}\n\n\t},\n\n\t_buildFace: function ( faceIndexV, faceIndexU, faceIndexN ) {\n\n\t\tlet subGroupInUse = this.rawMesh.subGroupInUse;\n\t\tlet scope = this;\n\t\tlet updateSubGroupInUse = function () {\n\n\t\t\tlet faceIndexVi = parseInt( faceIndexV );\n\t\t\tlet indexPointerV = 3 * ( faceIndexVi > 0 ? faceIndexVi - 1 : faceIndexVi + scope.vertices.length / 3 );\n\t\t\tlet indexPointerC = scope.colors.length > 0 ? indexPointerV : null;\n\n\t\t\tlet vertices = subGroupInUse.vertices;\n\t\t\tvertices.push( scope.vertices[ indexPointerV ++ ] );\n\t\t\tvertices.push( scope.vertices[ indexPointerV ++ ] );\n\t\t\tvertices.push( scope.vertices[ indexPointerV ] );\n\n\t\t\tif ( indexPointerC !== null ) {\n\n\t\t\t\tlet colors = subGroupInUse.colors;\n\t\t\t\tcolors.push( scope.colors[ indexPointerC ++ ] );\n\t\t\t\tcolors.push( scope.colors[ indexPointerC ++ ] );\n\t\t\t\tcolors.push( scope.colors[ indexPointerC ] );\n\n\t\t\t}\n\t\t\tif ( faceIndexU ) {\n\n\t\t\t\tlet faceIndexUi = parseInt( faceIndexU );\n\t\t\t\tlet indexPointerU = 2 * ( faceIndexUi > 0 ? faceIndexUi - 1 : faceIndexUi + scope.uvs.length / 2 );\n\t\t\t\tlet uvs = subGroupInUse.uvs;\n\t\t\t\tuvs.push( scope.uvs[ indexPointerU ++ ] );\n\t\t\t\tuvs.push( scope.uvs[ indexPointerU ] );\n\n\t\t\t}\n\t\t\tif ( faceIndexN && ! scope.disregardNormals ) {\n\n\t\t\t\tlet faceIndexNi = parseInt( faceIndexN );\n\t\t\t\tlet indexPointerN = 3 * ( faceIndexNi > 0 ? faceIndexNi - 1 : faceIndexNi + scope.normals.length / 3 );\n\t\t\t\tlet normals = subGroupInUse.normals;\n\t\t\t\tnormals.push( scope.normals[ indexPointerN ++ ] );\n\t\t\t\tnormals.push( scope.normals[ indexPointerN ++ ] );\n\t\t\t\tnormals.push( scope.normals[ indexPointerN ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tif ( this.useIndices ) {\n\n\t\t\tif ( this.disregardNormals ) faceIndexN = undefined;\n\t\t\tlet mappingName = faceIndexV + ( faceIndexU ? '_' + faceIndexU : '_n' ) + ( faceIndexN ? '_' + faceIndexN : '_n' );\n\t\t\tlet indicesPointer = subGroupInUse.indexMappings[ mappingName ];\n\t\t\tif ( indicesPointer === undefined || indicesPointer === null ) {\n\n\t\t\t\tindicesPointer = this.rawMesh.subGroupInUse.vertices.length / 3;\n\t\t\t\tupdateSubGroupInUse();\n\t\t\t\tsubGroupInUse.indexMappings[ mappingName ] = indicesPointer;\n\t\t\t\tsubGroupInUse.indexMappingsCount ++;\n\n\t\t\t} else {\n\n\t\t\t\tthis.rawMesh.counts.doubleIndicesCount ++;\n\n\t\t\t}\n\t\t\tsubGroupInUse.indices.push( indicesPointer );\n\n\t\t} else {\n\n\t\t\tupdateSubGroupInUse();\n\n\t\t}\n\t\tthis.rawMesh.counts.faceCount ++;\n\n\t},\n\n\t_createRawMeshReport: function ( inputObjectCount ) {\n\n\t\treturn 'Input Object number: ' + inputObjectCount +\n\t\t\t'\\n\\tObject name: ' + this.rawMesh.objectName +\n\t\t\t'\\n\\tGroup name: ' + this.rawMesh.groupName +\n\t\t\t'\\n\\tMtllib name: ' + this.rawMesh.mtllibName +\n\t\t\t'\\n\\tVertex count: ' + this.vertices.length / 3 +\n\t\t\t'\\n\\tNormal count: ' + this.normals.length / 3 +\n\t\t\t'\\n\\tUV count: ' + this.uvs.length / 2 +\n\t\t\t'\\n\\tSmoothingGroup count: ' + this.rawMesh.counts.smoothingGroupCount +\n\t\t\t'\\n\\tMaterial count: ' + this.rawMesh.counts.mtlCount +\n\t\t\t'\\n\\tReal MeshOutputGroup count: ' + this.rawMesh.subGroups.length;\n\n\t},\n\n\t/**\n\t * Clear any empty subGroup and calculate absolute vertex, normal and uv counts\n\t */\n\t_finalizeRawMesh: function () {\n\n\t\tlet meshOutputGroupTemp = [];\n\t\tlet meshOutputGroup;\n\t\tlet absoluteVertexCount = 0;\n\t\tlet absoluteIndexMappingsCount = 0;\n\t\tlet absoluteIndexCount = 0;\n\t\tlet absoluteColorCount = 0;\n\t\tlet absoluteNormalCount = 0;\n\t\tlet absoluteUvCount = 0;\n\t\tlet indices;\n\t\tfor ( let name in this.rawMesh.subGroups ) {\n\n\t\t\tmeshOutputGroup = this.rawMesh.subGroups[ name ];\n\t\t\tif ( meshOutputGroup.vertices.length > 0 ) {\n\n\t\t\t\tindices = meshOutputGroup.indices;\n\t\t\t\tif ( indices.length > 0 && absoluteIndexMappingsCount > 0 ) {\n\n\t\t\t\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\t\t\t\tindices[ i ] = indices[ i ] + absoluteIndexMappingsCount;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tmeshOutputGroupTemp.push( meshOutputGroup );\n\t\t\t\tabsoluteVertexCount += meshOutputGroup.vertices.length;\n\t\t\t\tabsoluteIndexMappingsCount += meshOutputGroup.indexMappingsCount;\n\t\t\t\tabsoluteIndexCount += meshOutputGroup.indices.length;\n\t\t\t\tabsoluteColorCount += meshOutputGroup.colors.length;\n\t\t\t\tabsoluteUvCount += meshOutputGroup.uvs.length;\n\t\t\t\tabsoluteNormalCount += meshOutputGroup.normals.length;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// do not continue if no result\n\t\tlet result = null;\n\t\tif ( meshOutputGroupTemp.length > 0 ) {\n\n\t\t\tresult = {\n\t\t\t\tname: this.rawMesh.groupName !== '' ? this.rawMesh.groupName : this.rawMesh.objectName,\n\t\t\t\tsubGroups: meshOutputGroupTemp,\n\t\t\t\tabsoluteVertexCount: absoluteVertexCount,\n\t\t\t\tabsoluteIndexCount: absoluteIndexCount,\n\t\t\t\tabsoluteColorCount: absoluteColorCount,\n\t\t\t\tabsoluteNormalCount: absoluteNormalCount,\n\t\t\t\tabsoluteUvCount: absoluteUvCount,\n\t\t\t\tfaceCount: this.rawMesh.counts.faceCount,\n\t\t\t\tdoubleIndicesCount: this.rawMesh.counts.doubleIndicesCount\n\t\t\t};\n\n\t\t}\n\t\treturn result;\n\n\t},\n\n\t_processCompletedMesh: function () {\n\n\t\tlet result = this._finalizeRawMesh();\n\t\tlet haveMesh = result !== null;\n\t\tif ( haveMesh ) {\n\n\t\t\tif ( this.colors.length > 0 && this.colors.length !== this.vertices.length ) {\n\n\t\t\t\tthis.callbacks.onError( 'Vertex Colors were detected, but vertex count and color count do not match!' );\n\n\t\t\t}\n\t\t\tif ( this.logging.enabled && this.logging.debug ) console.debug( this._createRawMeshReport( this.inputObjectCount ) );\n\t\t\tthis.inputObjectCount ++;\n\n\t\t\tthis._buildMesh( result );\n\t\t\tlet progressBytesPercent = this.globalCounts.currentByte / this.globalCounts.totalBytes;\n\t\t\tthis._onProgress( 'Completed [o: ' + this.rawMesh.objectName + ' g:' + this.rawMesh.groupName + '' +\n\t\t\t\t'] Total progress: ' + ( progressBytesPercent * 100 ).toFixed( 2 ) + '%' );\n\t\t\tthis._resetRawMesh();\n\n\t\t}\n\t\treturn haveMesh;\n\n\t},\n\n\t/**\n\t * SubGroups are transformed to too intermediate format that is forwarded to the MeshReceiver.\n\t * It is ensured that SubGroups only contain objects with vertices (no need to check).\n\t *\n\t * @param result\n\t */\n\t_buildMesh: function ( result ) {\n\n\t\tlet meshOutputGroups = result.subGroups;\n\n\t\tlet vertexFA = new Float32Array( result.absoluteVertexCount );\n\t\tthis.globalCounts.vertices += result.absoluteVertexCount / 3;\n\t\tthis.globalCounts.faces += result.faceCount;\n\t\tthis.globalCounts.doubleIndicesCount += result.doubleIndicesCount;\n\t\tlet indexUA = ( result.absoluteIndexCount > 0 ) ? new Uint32Array( result.absoluteIndexCount ) : null;\n\t\tlet colorFA = ( result.absoluteColorCount > 0 ) ? new Float32Array( result.absoluteColorCount ) : null;\n\t\tlet normalFA = ( result.absoluteNormalCount > 0 ) ? new Float32Array( result.absoluteNormalCount ) : null;\n\t\tlet uvFA = ( result.absoluteUvCount > 0 ) ? new Float32Array( result.absoluteUvCount ) : null;\n\t\tlet haveVertexColors = colorFA !== null;\n\n\t\tlet meshOutputGroup;\n\t\tlet materialNames = [];\n\n\t\tlet createMultiMaterial = ( meshOutputGroups.length > 1 );\n\t\tlet materialIndex = 0;\n\t\tlet materialIndexMapping = [];\n\t\tlet selectedMaterialIndex;\n\t\tlet materialGroup;\n\t\tlet materialGroups = [];\n\n\t\tlet vertexFAOffset = 0;\n\t\tlet indexUAOffset = 0;\n\t\tlet colorFAOffset = 0;\n\t\tlet normalFAOffset = 0;\n\t\tlet uvFAOffset = 0;\n\t\tlet materialGroupOffset = 0;\n\t\tlet materialGroupLength = 0;\n\n\t\tlet materialOrg, material, materialName, materialNameOrg;\n\t\t// only one specific face type\n\t\tfor ( let oodIndex in meshOutputGroups ) {\n\n\t\t\tif ( ! meshOutputGroups.hasOwnProperty( oodIndex ) ) continue;\n\t\t\tmeshOutputGroup = meshOutputGroups[ oodIndex ];\n\n\t\t\tmaterialNameOrg = meshOutputGroup.materialName;\n\t\t\tif ( this.rawMesh.faceType < 4 ) {\n\n\t\t\t\tmaterialName = materialNameOrg + ( haveVertexColors ? '_vertexColor' : '' ) + ( meshOutputGroup.smoothingGroup === 0 ? '_flat' : '' );\n\n\n\t\t\t} else {\n\n\t\t\t\tmaterialName = this.rawMesh.faceType === 6 ? 'defaultPointMaterial' : 'defaultLineMaterial';\n\n\t\t\t}\n\t\t\tmaterialOrg = this.materials[ materialNameOrg ];\n\t\t\tmaterial = this.materials[ materialName ];\n\n\t\t\t// both original and derived names do not lead to an existing material => need to use a default material\n\t\t\tif ( ( materialOrg === undefined || materialOrg === null ) && ( material === undefined || material === null ) ) {\n\n\t\t\t\tmaterialName = haveVertexColors ? 'defaultVertexColorMaterial' : 'defaultMaterial';\n\t\t\t\tmaterial = this.materials[ materialName ];\n\t\t\t\tif ( this.logging.enabled ) {\n\n\t\t\t\t\tconsole.info( 'object_group \"' + meshOutputGroup.objectName + '_' +\n\t\t\t\t\t\tmeshOutputGroup.groupName + '\" was defined with unresolvable material \"' +\n\t\t\t\t\t\tmaterialNameOrg + '\"! Assigning \"' + materialName + '\".' );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif ( material === undefined || material === null ) {\n\n\t\t\t\tlet materialCloneInstructions = {\n\t\t\t\t\tmaterialNameOrg: materialNameOrg,\n\t\t\t\t\tmaterialName: materialName,\n\t\t\t\t\tmaterialProperties: {\n\t\t\t\t\t\tvertexColors: haveVertexColors ? 2 : 0,\n\t\t\t\t\t\tflatShading: meshOutputGroup.smoothingGroup === 0\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlet payload = {\n\t\t\t\t\tcmd: 'assetAvailable',\n\t\t\t\t\ttype: 'material',\n\t\t\t\t\tmaterials: {\n\t\t\t\t\t\tmaterialCloneInstructions: materialCloneInstructions\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.callbacks.onAssetAvailable( payload );\n\n\t\t\t\t// only set materials if they don't exist, yet\n\t\t\t\tlet matCheck = this.materials[ materialName ];\n\t\t\t\tif ( matCheck === undefined || matCheck === null ) {\n\n\t\t\t\t\tthis.materials[ materialName ] = materialCloneInstructions;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( createMultiMaterial ) {\n\n\t\t\t\t// re-use material if already used before. Reduces materials array size and eliminates duplicates\n\t\t\t\tselectedMaterialIndex = materialIndexMapping[ materialName ];\n\t\t\t\tif ( ! selectedMaterialIndex ) {\n\n\t\t\t\t\tselectedMaterialIndex = materialIndex;\n\t\t\t\t\tmaterialIndexMapping[ materialName ] = materialIndex;\n\t\t\t\t\tmaterialNames.push( materialName );\n\t\t\t\t\tmaterialIndex ++;\n\n\t\t\t\t}\n\t\t\t\tmaterialGroupLength = this.useIndices ? meshOutputGroup.indices.length : meshOutputGroup.vertices.length / 3;\n\t\t\t\tmaterialGroup = {\n\t\t\t\t\tstart: materialGroupOffset,\n\t\t\t\t\tcount: materialGroupLength,\n\t\t\t\t\tindex: selectedMaterialIndex\n\t\t\t\t};\n\t\t\t\tmaterialGroups.push( materialGroup );\n\t\t\t\tmaterialGroupOffset += materialGroupLength;\n\n\t\t\t} else {\n\n\t\t\t\tmaterialNames.push( materialName );\n\n\t\t\t}\n\n\t\t\tvertexFA.set( meshOutputGroup.vertices, vertexFAOffset );\n\t\t\tvertexFAOffset += meshOutputGroup.vertices.length;\n\n\t\t\tif ( indexUA ) {\n\n\t\t\t\tindexUA.set( meshOutputGroup.indices, indexUAOffset );\n\t\t\t\tindexUAOffset += meshOutputGroup.indices.length;\n\n\t\t\t}\n\n\t\t\tif ( colorFA ) {\n\n\t\t\t\tcolorFA.set( meshOutputGroup.colors, colorFAOffset );\n\t\t\t\tcolorFAOffset += meshOutputGroup.colors.length;\n\n\t\t\t}\n\n\t\t\tif ( normalFA ) {\n\n\t\t\t\tnormalFA.set( meshOutputGroup.normals, normalFAOffset );\n\t\t\t\tnormalFAOffset += meshOutputGroup.normals.length;\n\n\t\t\t}\n\t\t\tif ( uvFA ) {\n\n\t\t\t\tuvFA.set( meshOutputGroup.uvs, uvFAOffset );\n\t\t\t\tuvFAOffset += meshOutputGroup.uvs.length;\n\n\t\t\t}\n\n\t\t\tif ( this.logging.enabled && this.logging.debug ) {\n\n\t\t\t\tlet materialIndexLine = ( selectedMaterialIndex === undefined || selectedMaterialIndex === null ) ? '' : '\\n\\t\\tmaterialIndex: ' + selectedMaterialIndex;\n\t\t\t\tlet createdReport = '\\tOutput Object no.: ' + this.outputObjectCount +\n\t\t\t\t\t'\\n\\t\\tgroupName: ' + meshOutputGroup.groupName +\n\t\t\t\t\t'\\n\\t\\tIndex: ' + meshOutputGroup.index +\n\t\t\t\t\t'\\n\\t\\tfaceType: ' + this.rawMesh.faceType +\n\t\t\t\t\t'\\n\\t\\tmaterialName: ' + meshOutputGroup.materialName +\n\t\t\t\t\t'\\n\\t\\tsmoothingGroup: ' + meshOutputGroup.smoothingGroup +\n\t\t\t\t\tmaterialIndexLine +\n\t\t\t\t\t'\\n\\t\\tobjectName: ' + meshOutputGroup.objectName +\n\t\t\t\t\t'\\n\\t\\t#vertices: ' + meshOutputGroup.vertices.length / 3 +\n\t\t\t\t\t'\\n\\t\\t#indices: ' + meshOutputGroup.indices.length +\n\t\t\t\t\t'\\n\\t\\t#colors: ' + meshOutputGroup.colors.length / 3 +\n\t\t\t\t\t'\\n\\t\\t#uvs: ' + meshOutputGroup.uvs.length / 2 +\n\t\t\t\t\t'\\n\\t\\t#normals: ' + meshOutputGroup.normals.length / 3;\n\t\t\t\tconsole.debug( createdReport );\n\n\t\t\t}\n\n\t\t}\n\t\tthis.outputObjectCount ++;\n\t\tthis.callbacks.onAssetAvailable(\n\t\t\t{\n\t\t\t\tcmd: 'assetAvailable',\n\t\t\t\ttype: 'mesh',\n\t\t\t\tprogress: {\n\t\t\t\t\tnumericalValue: this.globalCounts.currentByte / this.globalCounts.totalBytes\n\t\t\t\t},\n\t\t\t\tparams: {\n\t\t\t\t\tmeshName: result.name\n\t\t\t\t},\n\t\t\t\tmaterials: {\n\t\t\t\t\tmultiMaterial: createMultiMaterial,\n\t\t\t\t\tmaterialNames: materialNames,\n\t\t\t\t\tmaterialGroups: materialGroups\n\t\t\t\t},\n\t\t\t\tbuffers: {\n\t\t\t\t\tvertices: vertexFA,\n\t\t\t\t\tindices: indexUA,\n\t\t\t\t\tcolors: colorFA,\n\t\t\t\t\tnormals: normalFA,\n\t\t\t\t\tuvs: uvFA\n\t\t\t\t},\n\t\t\t\t// 0: mesh, 1: line, 2: point\n\t\t\t\tgeometryType: this.rawMesh.faceType < 4 ? 0 : ( this.rawMesh.faceType === 6 ) ? 2 : 1\n\t\t\t},\n\t\t\t[ vertexFA.buffer ],\n\t\t\tindexUA !== null ? [ indexUA.buffer ] : null,\n\t\t\tcolorFA !== null ? [ colorFA.buffer ] : null,\n\t\t\tnormalFA !== null ? [ normalFA.buffer ] : null,\n\t\t\tuvFA !== null ? [ uvFA.buffer ] : null\n\t\t);\n\n\t},\n\n\t_finalizeParsing: function () {\n\n\t\tif ( this.logging.enabled ) console.info( 'Global output object count: ' + this.outputObjectCount );\n\t\tif ( this._processCompletedMesh() && this.logging.enabled ) {\n\n\t\t\tlet parserFinalReport = 'Overall counts: ' +\n\t\t\t\t'\\n\\tVertices: ' + this.globalCounts.vertices +\n\t\t\t\t'\\n\\tFaces: ' + this.globalCounts.faces +\n\t\t\t\t'\\n\\tMultiple definitions: ' + this.globalCounts.doubleIndicesCount;\n\t\t\tconsole.info( parserFinalReport );\n\n\t\t}\n\n\t}\n};\n\nexport { OBJLoader2Parser };\n"]}]}